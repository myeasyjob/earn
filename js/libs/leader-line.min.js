var LeaderLine=function(){"use strict";var e,t,a,n,o,i,r,l,s,d,u,p,c,h="leader-line",S={top:1,right:2,bottom:3,left:4},f={straight:1,arc:2,fluid:3,magnet:4,grid:5},g=window.DEFS_HTML,E=window.SYMBOLS,y=window.PLUG_KEY_2_ID,m=window.PLUG_2_SYMBOL,_=window.DEFAULT_END_PLUG,b=[1,2,3,4],w={x:"left",y:"top",width:"width",height:"height"},k=1/4*Math.PI,x=/^\s*(\-?[\d\.]+)\s*(\%)?\s*$/,v="http://www.w3.org/2000/svg",L="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style&&!window.navigator.msPointerEnabled,T=!L&&!!document.uniqueID,O="MozAppearance"in document.documentElement.style,A=!(L||O||!window.chrome||!window.CSS),M=!(L||T||O||A||window.chrome||!("WebkitAppearance"in document.documentElement.style)),C=T||L?.2:.1,N={path:3,lineColor:"coral",lineSize:4,plugSE:["behind",_],plugSizeSE:[1,1],lineOutlineEnabled:!1,lineOutlineColor:"indianred",lineOutlineSize:.25,plugOutlineEnabledSE:[!1,!1],plugOutlineSizeSE:[1,1]},I=(u={}.toString,p={}.hasOwnProperty.toString,c=p.call(Object),function(e){var t,a;return e&&"[object Object]"===u.call(e)&&(!(t=Object.getPrototypeOf(e))||(a=t.hasOwnProperty("constructor")&&t.constructor)&&"function"==typeof a&&p.call(a)===c)}),P=Number.isFinite||function(e){return"number"==typeof e&&window.isFinite(e)},W=window.anim,V=window.pathDataPolyfill,H=window.AnimEvent,F={line_altColor:{iniValue:!1},line_color:{},line_colorTra:{iniValue:!1},line_strokeWidth:{},plug_enabled:{iniValue:!1},plug_enabledSE:{hasSE:!0,iniValue:!1},plug_plugSE:{hasSE:!0,iniValue:"behind"},plug_colorSE:{hasSE:!0},plug_colorTraSE:{hasSE:!0,iniValue:!1},plug_markerWidthSE:{hasSE:!0},plug_markerHeightSE:{hasSE:!0},lineOutline_enabled:{iniValue:!1},lineOutline_color:{},lineOutline_colorTra:{iniValue:!1},lineOutline_strokeWidth:{},lineOutline_inStrokeWidth:{},plugOutline_enabledSE:{hasSE:!0,iniValue:!1},plugOutline_plugSE:{hasSE:!0,iniValue:"behind"},plugOutline_colorSE:{hasSE:!0},plugOutline_colorTraSE:{hasSE:!0,iniValue:!1},plugOutline_strokeWidthSE:{hasSE:!0},plugOutline_inStrokeWidthSE:{hasSE:!0},position_socketXYSE:{hasSE:!0,hasProps:!0},position_plugOverheadSE:{hasSE:!0},position_path:{},position_lineStrokeWidth:{},position_socketGravitySE:{hasSE:!0},path_pathData:{},path_edge:{hasProps:!0},viewBox_bBox:{hasProps:!0},viewBox_plugBCircleSE:{hasSE:!0},lineMask_enabled:{iniValue:!1},lineMask_outlineMode:{iniValue:!1},lineMask_x:{},lineMask_y:{},lineOutlineMask_x:{},lineOutlineMask_y:{},maskBGRect_x:{},maskBGRect_y:{},capsMaskAnchor_enabledSE:{hasSE:!0,iniValue:!1},capsMaskAnchor_pathDataSE:{hasSE:!0},capsMaskAnchor_strokeWidthSE:{hasSE:!0},capsMaskMarker_enabled:{iniValue:!1},capsMaskMarker_enabledSE:{hasSE:!0,iniValue:!1},capsMaskMarker_plugSE:{hasSE:!0,iniValue:"behind"},capsMaskMarker_markerWidthSE:{hasSE:!0},capsMaskMarker_markerHeightSE:{hasSE:!0},caps_enabled:{iniValue:!1},attach_plugSideLenSE:{hasSE:!0},attach_plugBackLenSE:{hasSE:!0}},B={show_on:{},show_effect:{},show_animOptions:{},show_animId:{},show_inAnim:{}},G=[],D={},R=0,j={},z=0;function Y(e,t){var a,n;return typeof e!=typeof t||(a=I(e)?"obj":Array.isArray(e)?"array":"")!=(I(t)?"obj":Array.isArray(t)?"array":"")||("obj"===a?Y(n=Object.keys(e).sort(),Object.keys(t).sort())||n.some((function(a){return Y(e[a],t[a])})):"array"===a?e.length!==t.length||e.some((function(e,a){return Y(e,t[a])})):e!==t)}function U(e){return e?I(e)?Object.keys(e).reduce((function(t,a){return t[a]=U(e[a]),t}),{}):Array.isArray(e)?e.map(U):e:e}function X(e){var t,a,n,o=1,i=e=(e+"").trim();function r(e){var t=1,a=x.exec(e);return a&&(t=parseFloat(a[1]),a[2]?t=t>=0&&t<=100?t/100:1:(t<0||t>1)&&(t=1)),t}return(t=/^(rgba|hsla|hwb|gray|device\-cmyk)\s*\(([\s\S]+)\)$/i.exec(e))?(a=t[1].toLowerCase(),n=t[2].trim().split(/\s*,\s*/),"rgba"===a&&4===n.length?(o=r(n[3]),i="rgb("+n.slice(0,3).join(", ")+")"):"hsla"===a&&4===n.length?(o=r(n[3]),i="hsl("+n.slice(0,3).join(", ")+")"):"hwb"===a&&4===n.length?(o=r(n[3]),i="hwb("+n.slice(0,3).join(", ")+")"):"gray"===a&&2===n.length?(o=r(n[1]),i="gray("+n[0]+")"):"device-cmyk"===a&&n.length>=5&&(o=r(n[4]),i="device-cmyk("+n.slice(0,4).join(", ")+")")):(t=/^\#(?:([\da-f]{6})([\da-f]{2})|([\da-f]{3})([\da-f]))$/i.exec(e))?t[1]?(o=parseInt(t[2],16)/255,i="#"+t[1]):(o=parseInt(t[4]+t[4],16)/255,i="#"+t[3]):"transparent"===e.toLocaleLowerCase()&&(o=0),[o,i]}function K(e,t,a){var n,o;return"onmouseenter"in e&&"onmouseleave"in e?(e.addEventListener("mouseenter",t,!1),e.addEventListener("mouseleave",a,!1),function(){e.removeEventListener("mouseenter",t,!1),e.removeEventListener("mouseleave",a,!1)}):(console.warn("mouseenter and mouseleave events polyfill is enabled."),n=function(e){e.relatedTarget&&(e.relatedTarget===this||this.compareDocumentPosition(e.relatedTarget)&Node.DOCUMENT_POSITION_CONTAINED_BY)||t.apply(this,arguments)},e.addEventListener("mouseover",n),o=function(e){e.relatedTarget&&(e.relatedTarget===this||this.compareDocumentPosition(e.relatedTarget)&Node.DOCUMENT_POSITION_CONTAINED_BY)||a.apply(this,arguments)},e.addEventListener("mouseout",o),function(){e.removeEventListener("mouseover",n,!1),e.removeEventListener("mouseout",o,!1)})}function Z(e){return!(!e||e.nodeType!==Node.ELEMENT_NODE||"function"!=typeof e.getBoundingClientRect)}function q(e,t){var a,n,o,i,r={};if(!(o=e.ownerDocument))return console.error("Cannot get document that contains the element."),null;if(e.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_DISCONNECTED)return console.error("A disconnected element was passed."),null;for(n in a=e.getBoundingClientRect())r[n]=a[n];if(!t){if(!(i=o.defaultView))return console.error("Cannot get window that contains the element."),null;r.left+=i.pageXOffset,r.right+=i.pageXOffset,r.top+=i.pageYOffset,r.bottom+=i.pageYOffset}return r}function Q(e,t){var a,n,o=[],i=e;for(t=t||window;;){if(!(a=i.ownerDocument))return console.error("Cannot get document that contains the element."),null;if(!(n=a.defaultView))return console.error("Cannot get window that contains the element."),null;if(n===t)break;if(!(i=n.frameElement))return console.error("`baseWindow` was not found."),null;o.unshift(i)}return o}function J(e,t){var a,n,o=0,i=0;return(n=Q(e,t=t||window))?n.length?(n.forEach((function(e,t){var a=q(e,t>0);o+=a.left,i+=a.top,a=function(e){var t=e.ownerDocument.defaultView.getComputedStyle(e,"");return{left:e.clientLeft+parseFloat(t.paddingLeft),top:e.clientTop+parseFloat(t.paddingTop)}}(e),o+=a.left,i+=a.top})),(a=q(e,!0)).left+=o,a.right+=o,a.top+=i,a.bottom+=i,a):q(e):null}function $(e,t){var a,n,o;if(!(a=Q(e))||!(n=Q(t)))throw new Error("Cannot get frames.");return a.length&&n.length&&(a.reverse(),n.reverse(),a.some((function(e){return n.some((function(t){return t===e&&(o=t.contentWindow,!0)}))}))),o||window}function ee(e,t){var a=e.x-t.x,n=e.y-t.y;return Math.sqrt(a*a+n*n)}function te(e,t,a){var n=t.x-e.x,o=t.y-e.y;return{x:e.x+n*a,y:e.y+o*a,angle:Math.atan2(o,n)/(Math.PI/180)}}function ae(e,t,a,n){var o=t.x-e.x,i=t.y-e.y,r=n.x-a.x,l=n.y-a.y,s=(-i*(e.x-a.x)+o*(e.y-a.y))/(-r*i+o*l),d=(r*(e.y-a.y)-l*(e.x-a.x))/(-r*i+o*l);return s>=0&&s<=1&&d>=0&&d<=1?{x:e.x+d*o,y:e.y+d*i}:null}function ne(e,t,a){var n=Math.atan2(e.y-t.y,t.x-e.x);return{x:t.x+Math.cos(n)*a,y:t.y+Math.sin(n)*a*-1}}function oe(e,t,a,n,o){var i=o*o,r=i*o,l=1-o,s=l*l,d=s*l,u=d*e.x+3*s*o*t.x+3*l*i*a.x+r*n.x,p=d*e.y+3*s*o*t.y+3*l*i*a.y+r*n.y,c=e.x+2*o*(t.x-e.x)+i*(a.x-2*t.x+e.x),h=e.y+2*o*(t.y-e.y)+i*(a.y-2*t.y+e.y),S=t.x+2*o*(a.x-t.x)+i*(n.x-2*a.x+t.x),f=t.y+2*o*(a.y-t.y)+i*(n.y-2*a.y+t.y),g=l*e.x+o*t.x,E=l*e.y+o*t.y,y=l*a.x+o*n.x,m=l*a.y+o*n.y,_=90-180*Math.atan2(c-S,h-f)/Math.PI;return{x:u,y:p,fromP2:{x:c,y:h},toP1:{x:S,y:f},fromP1:{x:g,y:E},toP2:{x:y,y:m},angle:_+=_>180?-180:180}}function ie(e,t,a,n,o){function i(e,t,a,n,o){return e*(e*(-3*t+9*a-9*n+3*o)+6*t-12*a+6*n)-3*t+3*a}var r,l,s,d,u,p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],c=0;return r=(o=null==o||o>1?1:o<0?0:o)/2,[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816].forEach((function(o,h){s=i(l=r*o+r,e.x,t.x,a.x,n.x),d=i(l,e.y,t.y,a.y,n.y),u=s*s+d*d,c+=p[h]*Math.sqrt(u)})),r*c}function re(e,t,a,n,o){for(var i,r=.5,l=1-r;i=ie(e,t,a,n,l),!(Math.abs(i-o)<=.01);)l+=(i<o?1:-1)*(r/=2);return l}function le(e,t,a){var n=Math.atan2(e.y-t.y,t.x-e.x)+.5*Math.PI;return[{x:e.x+Math.cos(n)*a,y:e.y+Math.sin(n)*a*-1},{x:t.x+Math.cos(n)*a,y:t.y+Math.sin(n)*a*-1}]}function se(e,t,a,n,o,i){for(var r,l,s=ie(e,t,a,n)/i,d=1/(o>i?s*(o/i):s),u=[],p=0;l=(90-(r=oe(e,t,a,n,p)).angle)*(Math.PI/180),u.push({x:r.x+Math.cos(l)*o,y:r.y+Math.sin(l)*o*-1}),!(p>=1);)(p+=d)>1&&(p=1);return u}function de(e,t){var a;return e.forEach((function(e){var n=t?e.map((function(e){var a={x:e.x,y:e.y};return t(a),a})):e;a||(a=[{type:"M",values:[n[0].x,n[0].y]}]),a.push(n.length?2===n.length?{type:"L",values:[n[1].x,n[1].y]}:{type:"C",values:[n[1].x,n[1].y,n[2].x,n[2].y,n[3].x,n[3].y]}:{type:"Z",values:[]})})),a}function ue(e){var t=[],a=0;return e.forEach((function(e){var n=(2===e.length?ee:ie).apply(null,e);t.push(n),a+=n})),{segsLen:t,lenAll:a}}function pe(e){var t;return e.reduce((function(e,a){var n,o=a.values;switch(a.type){case"M":t={x:o[0],y:o[1]};break;case"L":n={x:o[0],y:o[1]},t&&(e+=ee(t,n)),t=n;break;case"C":n={x:o[4],y:o[5]},t&&(e+=ie(t,{x:o[0],y:o[1]},{x:o[2],y:o[3]},n)),t=n}return e}),0)}function ce(e,t){return null==e||null==t||e.length!==t.length||e.some((function(e,a){var n=t[a];return e.type!==n.type||e.values.some((function(e,t){return e!==n.values[t]}))}))}function he(e,t,a){e.events[t]?e.events[t].indexOf(a)<0&&e.events[t].push(a):e.events[t]=[a]}function Se(e,t,a){var n;e.events[t]&&(n=e.events[t].indexOf(a))>-1&&e.events[t].splice(n,1)}function fe(e){r&&clearTimeout(r),G.push(e),r=setTimeout((function(){traceLog.add("<execDelayedProcs>"),G.forEach((function(e){e()})),G=[],traceLog.add("</execDelayedProcs>")}),0)}function ge(e){setTimeout((function(){var t=e.parentNode,a=e.nextSibling;t.insertBefore(t.removeChild(e),a)}),0)}function Ee(e,t){e.reflowTargets.indexOf(t)<0&&e.reflowTargets.push(t)}function ye(e){e.reflowTargets.forEach((function(e){ge(e)})),e.reflowTargets=[]}function me(e,t,a,n,o,i,r){var s,d,u;"auto-start-reverse"===a?("boolean"!=typeof l&&(t.setAttribute("orient","auto-start-reverse"),l=t.orientType.baseVal===SVGMarkerElement.SVG_MARKER_ORIENT_UNKNOWN),l?t.setAttribute("orient",a):((s=o.createSVGTransform()).setRotate(180,0,0),i.transform.baseVal.appendItem(s),t.setAttribute("orient","auto"),u=!0)):(t.setAttribute("orient",a),!1===l&&i.transform.baseVal.clear()),d=t.viewBox.baseVal,u?(d.x=-n.right,d.y=-n.bottom):(d.x=n.left,d.y=n.top),d.width=n.width,d.height=n.height,T&&Ee(e,r)}function _e(e,t){return{prop:e?"markerEnd":"markerStart",orient:t?t.noRotate?"0":e?"auto":"auto-start-reverse":null}}function be(e,t){var a,n,o={};return"boolean"!=typeof d&&(d=!!window.SVGFEDropShadowElement&&!M),o.elmsAppend=[o.elmFilter=a=e.createElementNS(v,"filter")],a.filterUnits.baseVal=SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,a.x.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),a.y.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),a.width.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,100),a.height.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,100),a.id=t,d?(o.elmOffset=o.elmBlur=n=a.appendChild(e.createElementNS(v,"feDropShadow")),o.styleFlood=n.style):(o.elmBlur=a.appendChild(e.createElementNS(v,"feGaussianBlur")),o.elmOffset=n=a.appendChild(e.createElementNS(v,"feOffset")),n.result.baseVal="offsetblur",n=a.appendChild(e.createElementNS(v,"feFlood")),o.styleFlood=n.style,(n=a.appendChild(e.createElementNS(v,"feComposite"))).in2.baseVal="offsetblur",n.operator.baseVal=SVGFECompositeElement.SVG_FECOMPOSITE_OPERATOR_IN,(n=a.appendChild(e.createElementNS(v,"feMerge"))).appendChild(e.createElementNS(v,"feMergeNode")),n.appendChild(e.createElementNS(v,"feMergeNode")).in1.baseVal="SourceGraphic"),o}function we(e,t){Object.keys(t).forEach((function(a){var n=t[a];e[a]=null!=n.iniValue?n.hasSE?[n.iniValue,n.iniValue]:n.iniValue:n.hasSE?n.hasProps?[{},{}]:[]:n.hasProps?{}:null}))}function ke(e,t,a,n,o,i){return n!==t[a]&&(traceLog.add(i||a+"=%s",n),t[a]=n,o&&o.forEach((function(t){t(e,n,a)})),!0)}function xe(e){function t(e,t){return e+parseFloat(t)}var a=e.document,n=e.getComputedStyle(a.documentElement,""),o=e.getComputedStyle(a.body,""),i={x:0,y:0};return"static"!==o.position?(i.x-=[n.marginLeft,n.borderLeftWidth,n.paddingLeft,o.marginLeft,o.borderLeftWidth].reduce(t,0),i.y-=[n.marginTop,n.borderTopWidth,n.paddingTop,o.marginTop,o.borderTopWidth].reduce(t,0)):"static"!==n.position&&(i.x-=[n.marginLeft,n.borderLeftWidth].reduce(t,0),i.y-=[n.marginTop,n.borderTopWidth].reduce(t,0)),i}function ve(e){var t,a=e.document;a.getElementById("leader-line-defs")||(t=(new e.DOMParser).parseFromString(g,"image/svg+xml"),a.body.appendChild(t.documentElement),V(e))}function Le(a,n){traceLog.add("<bindWindow>");var i,r,l,s,d,u,p,c,S,f,g=a.aplStats,E=n.document,y=h+"-"+a._id;function m(e){var t=r.appendChild(E.createElementNS(v,"mask"));return t.id=e,t.maskUnits.baseVal=SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,[t.x,t.y,t.width,t.height].forEach((function(e){e.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0)})),t}function _(e){var t=r.appendChild(E.createElementNS(v,"marker"));return t.id=e,t.markerUnits.baseVal=SVGMarkerElement.SVG_MARKERUNITS_STROKEWIDTH,t.viewBox.baseVal||t.setAttribute("viewBox","0 0 0 0"),t}function b(e){return[e.width,e.height].forEach((function(e){e.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,100)})),e}a.pathList={},we(g,F),Object.keys(e).forEach((function(t){var n=t+"_enabled";g[n]&&(e[t].remove(a),g[n]=!1)})),a.baseWindow&&a.svg&&a.baseWindow.document.body.removeChild(a.svg),a.baseWindow=n,ve(n),a.bodyOffset=xe(n),a.svg=i=E.createElementNS(v,"svg"),i.className.baseVal=h,i.viewBox.baseVal||i.setAttribute("viewBox","0 0 0 0"),a.defs=r=i.appendChild(E.createElementNS(v,"defs")),a.linePath=s=r.appendChild(E.createElementNS(v,"path")),s.id=d=y+"-line-path",s.className.baseVal=h+"-line-path",M&&(s.style.fill="none"),a.lineShape=s=r.appendChild(E.createElementNS(v,"use")),s.id=u=y+"-line-shape",s.href.baseVal="#"+d,(l=r.appendChild(E.createElementNS(v,"g"))).id=p=y+"-caps",a.capsMaskAnchorSE=[0,1].map((function(){var e=l.appendChild(E.createElementNS(v,"path"));return e.className.baseVal=h+"-caps-mask-anchor",e})),a.lineMaskMarkerIdSE=[y+"-caps-mask-marker-0",y+"-caps-mask-marker-1"],a.capsMaskMarkerSE=[0,1].map((function(e){return _(a.lineMaskMarkerIdSE[e])})),a.capsMaskMarkerShapeSE=[0,1].map((function(e){var t=a.capsMaskMarkerSE[e].appendChild(E.createElementNS(v,"use"));return t.className.baseVal=h+"-caps-mask-marker-shape",t})),a.capsMaskLine=s=l.appendChild(E.createElementNS(v,"use")),s.className.baseVal=h+"-caps-mask-line",s.href.baseVal="#"+u,a.maskBGRect=s=b(r.appendChild(E.createElementNS(v,"rect"))),s.id=c=y+"-mask-bg-rect",s.className.baseVal=h+"-mask-bg-rect",M&&(s.style.fill="white"),a.lineMask=b(m(a.lineMaskId=y+"-line-mask")),a.lineMaskBG=s=a.lineMask.appendChild(E.createElementNS(v,"use")),s.href.baseVal="#"+c,a.lineMaskShape=s=a.lineMask.appendChild(E.createElementNS(v,"use")),s.className.baseVal=h+"-line-mask-shape",s.href.baseVal="#"+d,s.style.display="none",a.lineMaskCaps=s=a.lineMask.appendChild(E.createElementNS(v,"use")),s.href.baseVal="#"+p,a.lineOutlineMask=b(m(S=y+"-line-outline-mask")),(s=a.lineOutlineMask.appendChild(E.createElementNS(v,"use"))).href.baseVal="#"+c,a.lineOutlineMaskShape=s=a.lineOutlineMask.appendChild(E.createElementNS(v,"use")),s.className.baseVal=h+"-line-outline-mask-shape",s.href.baseVal="#"+d,a.lineOutlineMaskCaps=s=a.lineOutlineMask.appendChild(E.createElementNS(v,"use")),s.href.baseVal="#"+p,a.face=i.appendChild(E.createElementNS(v,"g")),a.lineFace=s=a.face.appendChild(E.createElementNS(v,"use")),s.href.baseVal="#"+u,a.lineOutlineFace=s=a.face.appendChild(E.createElementNS(v,"use")),s.href.baseVal="#"+u,s.style.mask="url(#"+S+")",s.style.display="none",a.plugMaskIdSE=[y+"-plug-mask-0",y+"-plug-mask-1"],a.plugMaskSE=[0,1].map((function(e){return m(a.plugMaskIdSE[e])})),a.plugMaskShapeSE=[0,1].map((function(e){var t=a.plugMaskSE[e].appendChild(E.createElementNS(v,"use"));return t.className.baseVal=h+"-plug-mask-shape",t})),f=[],a.plugOutlineMaskSE=[0,1].map((function(e){return m(f[e]=y+"-plug-outline-mask-"+e)})),a.plugOutlineMaskShapeSE=[0,1].map((function(e){var t=a.plugOutlineMaskSE[e].appendChild(E.createElementNS(v,"use"));return t.className.baseVal=h+"-plug-outline-mask-shape",t})),a.plugMarkerIdSE=[y+"-plug-marker-0",y+"-plug-marker-1"],a.plugMarkerSE=[0,1].map((function(e){var t=_(a.plugMarkerIdSE[e]);return M&&(t.markerUnits.baseVal=SVGMarkerElement.SVG_MARKERUNITS_USERSPACEONUSE),t})),a.plugMarkerShapeSE=[0,1].map((function(e){return a.plugMarkerSE[e].appendChild(E.createElementNS(v,"g"))})),a.plugFaceSE=[0,1].map((function(e){return a.plugMarkerShapeSE[e].appendChild(E.createElementNS(v,"use"))})),a.plugOutlineFaceSE=[0,1].map((function(e){var t=a.plugMarkerShapeSE[e].appendChild(E.createElementNS(v,"use"));return t.style.mask="url(#"+f[e]+")",t.style.display="none",t})),a.plugsFace=s=a.face.appendChild(E.createElementNS(v,"use")),s.className.baseVal=h+"-plugs-face",s.href.baseVal="#"+u,s.style.display="none",a.curStats.show_inAnim?(a.isShown=1,t[g.show_effect].stop(a,!0)):a.isShown||(i.style.visibility="hidden"),E.body.appendChild(i),[0,1,2].forEach((function(e){var t,n=a.options.labelSEM[e];n&&o(n,"label")&&(t=j[n._id]).conf.initSvg&&t.conf.initSvg(t,a)})),traceLog.add("</bindWindow>")}function Te(e,t){traceLog.add("<svgShow>"),t!==e.isShown&&(traceLog.add("on="+t),!!t!=!!e.isShown&&(e.svg.style.visibility=t?"":"hidden"),e.isShown=t,e.events&&e.events.svgShow&&e.events.svgShow.forEach((function(a){a(e,t)}))),traceLog.add("</svgShow>")}function Oe(t,a){var n={};a.line&&(n.line=function(e){traceLog.add("<updateLine>");var t=e.options,a=e.curStats,n=e.events,o=!1;return o=ke(e,a,"line_color",t.lineColor,n.cur_line_color)||o,o=ke(e,a,"line_colorTra",X(a.line_color)[0]<1)||o,(o=ke(e,a,"line_strokeWidth",t.lineSize,n.cur_line_strokeWidth)||o)||traceLog.add("not-updated"),traceLog.add("</updateLine>"),o}(t)),(a.plug||n.line)&&(n.plug=function(e){traceLog.add("<updatePlug>");var t=e.options,a=e.curStats,n=e.events,o=!1;return[0,1].forEach((function(i){var r,l,s,d,u,p,c,h,S=t.plugSE[i];o=ke(e,a.plug_enabledSE,i,"behind"!==S,null,"plug_enabledSE["+i+"]=%s")||o,o=ke(e,a.plug_plugSE,i,S,null,"plug_plugSE["+i+"]=%s")||o,o=ke(e,a.plug_colorSE,i,h=t.plugColorSE[i]||a.line_color,n.cur_plug_colorSE,"plug_colorSE["+i+"]=%s")||o,o=ke(e,a.plug_colorTraSE,i,X(h)[0]<1,null,"plug_colorTraSE["+i+"]=%s")||o,"behind"!==S&&(d=l=(r=E[m[S]]).widthR*t.plugSizeSE[i],u=s=r.heightR*t.plugSizeSE[i],M&&(d*=a.line_strokeWidth,u*=a.line_strokeWidth),o=ke(e,a.plug_markerWidthSE,i,d,null,"plug_markerWidthSE["+i+"]%_")||o,o=ke(e,a.plug_markerHeightSE,i,u,null,"plug_markerHeightSE["+i+"]%_")||o,a.capsMaskMarker_markerWidthSE[i]=l,a.capsMaskMarker_markerHeightSE[i]=s),a.plugOutline_plugSE[i]=a.capsMaskMarker_plugSE[i]=S,a.plug_enabledSE[i]?(h=a.line_strokeWidth/N.lineSize*t.plugSizeSE[i],a.position_plugOverheadSE[i]=r.overhead*h,a.viewBox_plugBCircleSE[i]=r.bCircle*h,p=r.sideLen*h,c=r.backLen*h):(a.position_plugOverheadSE[i]=-a.line_strokeWidth/2,a.viewBox_plugBCircleSE[i]=p=c=0),ke(e,a.attach_plugSideLenSE,i,p,n.cur_attach_plugSideLenSE,"attach_plugSideLenSE["+i+"]%_"),ke(e,a.attach_plugBackLenSE,i,c,n.cur_attach_plugBackLenSE,"attach_plugBackLenSE["+i+"]%_"),a.capsMaskAnchor_enabledSE[i]=!a.plug_enabledSE[i]})),(o=ke(e,a,"plug_enabled",a.plug_enabledSE[0]||a.plug_enabledSE[1])||o)||traceLog.add("not-updated"),traceLog.add("</updatePlug>"),o}(t)),(a.lineOutline||n.line)&&(n.lineOutline=function(e){traceLog.add("<updateLineOutline>");var t,a=e.options,n=e.curStats,o=!1;return o=ke(e,n,"lineOutline_enabled",a.lineOutlineEnabled)||o,o=ke(e,n,"lineOutline_color",a.lineOutlineColor)||o,o=ke(e,n,"lineOutline_colorTra",X(n.lineOutline_color)[0]<1)||o,t=n.line_strokeWidth*a.lineOutlineSize,o=ke(e,n,"lineOutline_strokeWidth",n.line_strokeWidth-2*t,null,"lineOutline_strokeWidth%_")||o,(o=ke(e,n,"lineOutline_inStrokeWidth",n.lineOutline_colorTra?n.lineOutline_strokeWidth+2*C:n.line_strokeWidth-t,null,"lineOutline_inStrokeWidth%_")||o)||traceLog.add("not-updated"),traceLog.add("</updateLineOutline>"),o}(t)),(a.plugOutline||n.line||n.plug||n.lineOutline)&&(n.plugOutline=function(e){traceLog.add("<updatePlugOutline>");var t=e.options,a=e.curStats,n=!1;return[0,1].forEach((function(o){var i,r=a.plugOutline_plugSE[o],l="behind"!==r?E[m[r]]:null;n=ke(e,a.plugOutline_enabledSE,o,t.plugOutlineEnabledSE[o]&&a.plug_enabled&&a.plug_enabledSE[o]&&!!l&&!!l.outlineBase,null,"plugOutline_enabledSE["+o+"]=%s")||n,n=ke(e,a.plugOutline_colorSE,o,i=t.plugOutlineColorSE[o]||a.lineOutline_color,null,"plugOutline_colorSE["+o+"]=%s")||n,n=ke(e,a.plugOutline_colorTraSE,o,X(i)[0]<1,null,"plugOutline_colorTraSE["+o+"]=%s")||n,l&&l.outlineBase&&((i=t.plugOutlineSizeSE[o])>l.outlineMax&&(i=l.outlineMax),i*=2*l.outlineBase,n=ke(e,a.plugOutline_strokeWidthSE,o,i,null,"plugOutline_strokeWidthSE["+o+"]%_")||n,n=ke(e,a.plugOutline_inStrokeWidthSE,o,a.plugOutline_colorTraSE[o]?i-C/(a.line_strokeWidth/N.lineSize)/t.plugSizeSE[o]*2:i/2,null,"plugOutline_inStrokeWidthSE["+o+"]%_")||n)})),n||traceLog.add("not-updated"),traceLog.add("</updatePlugOutline>"),n}(t)),(a.faces||n.line||n.plug||n.lineOutline||n.plugOutline)&&(n.faces=function(e){traceLog.add("<updateFaces>");var t,a=e.curStats,n=e.aplStats,o=e.events,i=!1;return!a.line_altColor&&ke(e,n,"line_color",t=a.line_color,o.apl_line_color)&&(e.lineFace.style.stroke=t,i=!0),ke(e,n,"line_strokeWidth",t=a.line_strokeWidth,o.apl_line_strokeWidth)&&(e.lineShape.style.strokeWidth=t+"px",i=!0,(O||T)&&(Ee(e,e.lineShape),T&&(Ee(e,e.lineFace),Ee(e,e.lineMaskCaps)))),ke(e,n,"lineOutline_enabled",t=a.lineOutline_enabled,o.apl_lineOutline_enabled)&&(e.lineOutlineFace.style.display=t?"inline":"none",i=!0),a.lineOutline_enabled&&(ke(e,n,"lineOutline_color",t=a.lineOutline_color,o.apl_lineOutline_color)&&(e.lineOutlineFace.style.stroke=t,i=!0),ke(e,n,"lineOutline_strokeWidth",t=a.lineOutline_strokeWidth,o.apl_lineOutline_strokeWidth,"lineOutline_strokeWidth%_")&&(e.lineOutlineMaskShape.style.strokeWidth=t+"px",i=!0,T&&(Ee(e,e.lineOutlineMaskCaps),Ee(e,e.lineOutlineFace))),ke(e,n,"lineOutline_inStrokeWidth",t=a.lineOutline_inStrokeWidth,o.apl_lineOutline_inStrokeWidth,"lineOutline_inStrokeWidth%_")&&(e.lineMaskShape.style.strokeWidth=t+"px",i=!0,T&&(Ee(e,e.lineOutlineMaskCaps),Ee(e,e.lineOutlineFace)))),ke(e,n,"plug_enabled",t=a.plug_enabled,o.apl_plug_enabled)&&(e.plugsFace.style.display=t?"inline":"none",i=!0),a.plug_enabled&&[0,1].forEach((function(r){var l=a.plug_plugSE[r],s="behind"!==l?E[m[l]]:null,d=_e(r,s);ke(e,n.plug_enabledSE,r,t=a.plug_enabledSE[r],o.apl_plug_enabledSE,"plug_enabledSE["+r+"]=%s")&&(e.plugsFace.style[d.prop]=t?"url(#"+e.plugMarkerIdSE[r]+")":"none",i=!0),a.plug_enabledSE[r]&&(ke(e,n.plug_plugSE,r,l,o.apl_plug_plugSE,"plug_plugSE["+r+"]=%s")&&(e.plugFaceSE[r].href.baseVal="#"+s.elmId,me(e,e.plugMarkerSE[r],d.orient,s.bBox,e.svg,e.plugMarkerShapeSE[r],e.plugsFace),i=!0,O&&Ee(e,e.plugsFace)),ke(e,n.plug_colorSE,r,t=a.plug_colorSE[r],o.apl_plug_colorSE,"plug_colorSE["+r+"]=%s")&&(e.plugFaceSE[r].style.fill=t,i=!0,(A||M||T)&&!a.line_colorTra&&Ee(e,T?e.lineMaskCaps:e.capsMaskLine)),["markerWidth","markerHeight"].forEach((function(l){var s="plug_"+l+"SE";ke(e,n[s],r,t=a[s][r],o["apl_"+s],s+"["+r+"]%_")&&(e.plugMarkerSE[r][l].baseVal.value=t,i=!0)})),ke(e,n.plugOutline_enabledSE,r,t=a.plugOutline_enabledSE[r],o.apl_plugOutline_enabledSE,"plugOutline_enabledSE["+r+"]=%s")&&(t?(e.plugFaceSE[r].style.mask="url(#"+e.plugMaskIdSE[r]+")",e.plugOutlineFaceSE[r].style.display="inline"):(e.plugFaceSE[r].style.mask="none",e.plugOutlineFaceSE[r].style.display="none"),i=!0),a.plugOutline_enabledSE[r]&&(ke(e,n.plugOutline_plugSE,r,l,o.apl_plugOutline_plugSE,"plugOutline_plugSE["+r+"]=%s")&&(e.plugOutlineFaceSE[r].href.baseVal=e.plugMaskShapeSE[r].href.baseVal=e.plugOutlineMaskShapeSE[r].href.baseVal="#"+s.elmId,[e.plugMaskSE[r],e.plugOutlineMaskSE[r]].forEach((function(e){e.x.baseVal.value=s.bBox.left,e.y.baseVal.value=s.bBox.top,e.width.baseVal.value=s.bBox.width,e.height.baseVal.value=s.bBox.height})),i=!0),ke(e,n.plugOutline_colorSE,r,t=a.plugOutline_colorSE[r],o.apl_plugOutline_colorSE,"plugOutline_colorSE["+r+"]=%s")&&(e.plugOutlineFaceSE[r].style.fill=t,i=!0,T&&(Ee(e,e.lineMaskCaps),Ee(e,e.lineOutlineMaskCaps))),ke(e,n.plugOutline_strokeWidthSE,r,t=a.plugOutline_strokeWidthSE[r],o.apl_plugOutline_strokeWidthSE,"plugOutline_strokeWidthSE["+r+"]%_")&&(e.plugOutlineMaskShapeSE[r].style.strokeWidth=t+"px",i=!0),ke(e,n.plugOutline_inStrokeWidthSE,r,t=a.plugOutline_inStrokeWidthSE[r],o.apl_plugOutline_inStrokeWidthSE,"plugOutline_inStrokeWidthSE["+r+"]%_")&&(e.plugMaskShapeSE[r].style.strokeWidth=t+"px",i=!0)))})),i||traceLog.add("not-updated"),traceLog.add("</updateFaces>"),i}(t)),(a.position||n.line||n.plug)&&(n.position=function(e){traceLog.add("<updatePosition>");var t,a,n,o,i,r,l,s,d,u,p,c,h,S,f,g,E,y,m,_=e.options,w=e.curStats,x=e.aplStats,v=w.position_socketXYSE,L=!1;function T(e,t){var a=1===t?{x:e.left+e.width/2,y:e.top}:2===t?{x:e.right,y:e.top+e.height/2}:3===t?{x:e.left+e.width/2,y:e.bottom}:{x:e.left,y:e.top+e.height/2};return a.socketId=t,a}function O(e){return{x:e.x,y:e.y}}function A(e,t){return e.x!==t.x||e.y!==t.y||e.socketId!==t.socketId}function M(e,t){var a=null==e?"auto":Array.isArray(e)?"array":"number";return a!==(null==t?"auto":Array.isArray(t)?"array":"number")||("array"===a?e[0]!==t[0]||e[1]!==t[1]:e!==t)}if(w.position_path=_.path,w.position_lineStrokeWidth=w.line_strokeWidth,w.position_socketGravitySE=t=U(_.socketGravitySE),a=[0,1].map((function(t){var a,n,o,i=_.anchorSE[t],r=e.optionIsAttach.anchorSE[t],l=!1!==r?j[i._id]:null,s=!1!==r&&l.conf.getStrokeWidth?l.conf.getStrokeWidth(l,e):0,d=!1!==r&&l.conf.getBBoxNest?l.conf.getBBoxNest(l,e,s):J(i,e.baseWindow);return w.capsMaskAnchor_pathDataSE[t]=!1!==r&&l.conf.getPathData?l.conf.getPathData(l,e,s):(n=null!=(a=d).right?a.right:a.left+a.width,o=null!=a.bottom?a.bottom:a.top+a.height,[{type:"M",values:[a.left,a.top]},{type:"L",values:[n,a.top]},{type:"L",values:[n,o]},{type:"L",values:[a.left,o]},{type:"Z",values:[]}]),w.capsMaskAnchor_strokeWidthSE[t]=s,d})),l=-1,_.socketSE[0]&&_.socketSE[1]?(v[0]=T(a[0],_.socketSE[0]),v[1]=T(a[1],_.socketSE[1])):(_.socketSE[0]||_.socketSE[1]?(_.socketSE[0]?(i=0,r=1):(i=1,r=0),v[i]=T(a[i],_.socketSE[i]),(o=b.map((function(e){return T(a[r],e)}))).forEach((function(e){var t=ee(e,v[i]);(t<l||-1===l)&&(v[r]=e,l=t)}))):(o=b.map((function(e){return T(a[1],e)})),b.map((function(e){return T(a[0],e)})).forEach((function(e){o.forEach((function(t){var a=ee(e,t);(a<l||-1===l)&&(v[0]=e,v[1]=t,l=a)}))}))),[0,1].forEach((function(e){var t,n;_.socketSE[e]||(a[e].width||a[e].height?a[e].width||4!==v[e].socketId&&2!==v[e].socketId?a[e].height||1!==v[e].socketId&&3!==v[e].socketId||(v[e].socketId=v[e?0:1].y-a[e].top>=0?3:1):v[e].socketId=v[e?0:1].x-a[e].left>=0?2:4:(t=v[e?0:1].x-a[e].left,n=v[e?0:1].y-a[e].top,v[e].socketId=Math.abs(t)>=Math.abs(n)?t>=0?2:4:n>=0?3:1))}))),w.position_path!==x.position_path&&traceLog.add("position_path"),w.position_lineStrokeWidth!==x.position_lineStrokeWidth&&traceLog.add("position_lineStrokeWidth"),[0,1].forEach((function(e){w.position_plugOverheadSE[e]!==x.position_plugOverheadSE[e]&&traceLog.add("position_plugOverheadSE["+e+"]"),A(v[e],x.position_socketXYSE[e])&&traceLog.add("position_socketXYSE["+e+"]"),M(t[e],x.position_socketGravitySE[e])&&traceLog.add("position_socketGravitySE["+e+"]")})),w.position_path!==x.position_path||w.position_lineStrokeWidth!==x.position_lineStrokeWidth||[0,1].some((function(e){return w.position_plugOverheadSE[e]!==x.position_plugOverheadSE[e]||A(v[e],x.position_socketXYSE[e])||M(t[e],x.position_socketGravitySE[e])}))){switch(traceLog.add("new-position"),e.pathList.baseVal=n=[],e.pathList.animVal=null,w.position_path){case 1:n.push([O(v[0]),O(v[1])]);break;case 2:c="number"==typeof t[0]&&t[0]>0||"number"==typeof t[1]&&t[1]>0,h=k*(c?-1:1),S=Math.atan2(v[1].y-v[0].y,v[1].x-v[0].x),f=-S+h,g=Math.PI-S-h,E=ee(v[0],v[1])/Math.sqrt(2)*.5522847,y={x:v[0].x+Math.cos(f)*E,y:v[0].y+Math.sin(f)*E*-1},m={x:v[1].x+Math.cos(g)*E,y:v[1].y+Math.sin(g)*E*-1},n.push([O(v[0]),y,m,O(v[1])]);break;case 3:case 4:d=[t[0],4===w.position_path?0:t[1]],u=[],p=[],v.forEach((function(e,t){var a,n,o,i,r,l=d[t];Array.isArray(l)?a={x:l[0],y:l[1]}:"number"==typeof l?a=1===e.socketId?{x:0,y:-l}:2===e.socketId?{x:l,y:0}:3===e.socketId?{x:0,y:l}:{x:-l,y:0}:(n=v[t?0:1],i=(o=w.position_plugOverheadSE[t])>0?120+(o>8?3.75*(o-8):0):80+(w.position_lineStrokeWidth>4?5*(w.position_lineStrokeWidth-4):0),1===e.socketId?((r=(e.y-n.y)/2)<i&&(r=i),a={x:0,y:-r}):2===e.socketId?((r=(n.x-e.x)/2)<i&&(r=i),a={x:r,y:0}):3===e.socketId?((r=(n.y-e.y)/2)<i&&(r=i),a={x:0,y:r}):((r=(e.x-n.x)/2)<i&&(r=i),a={x:-r,y:0})),u[t]=e.x+a.x,p[t]=e.y+a.y})),n.push([O(v[0]),{x:u[0],y:p[0]},{x:u[1],y:p[1]},O(v[1])]);break;case 5:!function(){var e,a=[[],[]],o=[];function i(e){return 1===e?3:2===e?4:3===e?1:2}function r(e){return 2===e||4===e?"x":"y"}function l(e,t,a){var n={x:e.x,y:e.y};if(a){if(a===i(e.dirId))throw new Error("Invalid dirId: "+a);n.dirId=a}else n.dirId=e.dirId;return 1===n.dirId?n.y-=t:2===n.dirId?n.x+=t:3===n.dirId?n.y+=t:n.x-=t,n}function s(e,t){return 1===t.dirId?e.y<=t.y:2===t.dirId?e.x>=t.x:3===t.dirId?e.y>=t.y:e.x<=t.x}function d(e,t){return 1===t.dirId||3===t.dirId?e.x===t.x:e.y===t.y}function u(e){return e[0]?{contain:0,notContain:1}:{contain:1,notContain:0}}function p(e,t,a){return Math.abs(t[a]-e[a])}function c(e,t,a){return"x"===a?e.x<t.x?2:4:e.y<t.y?3:1}function h(){var e,t,n,i,h=[s(o[1],o[0]),s(o[0],o[1])],S=[r(o[0].dirId),r(o[1].dirId)];if(S[0]===S[1]){if(h[0]&&h[1])return d(o[1],o[0])||(o[0][S[0]]===o[1][S[1]]?(a[0].push(o[0]),a[1].push(o[1])):(e=o[0][S[0]]+(o[1][S[1]]-o[0][S[0]])/2,a[0].push(l(o[0],Math.abs(e-o[0][S[0]]))),a[1].push(l(o[1],Math.abs(e-o[1][S[1]]))))),!1;h[0]!==h[1]?(t=u(h),(n=p(o[t.notContain],o[t.contain],S[t.notContain]))<30&&(o[t.notContain]=l(o[t.notContain],30-n)),a[t.notContain].push(o[t.notContain]),o[t.notContain]=l(o[t.notContain],30,d(o[t.contain],o[t.notContain])?"x"===S[t.notContain]?3:2:c(o[t.notContain],o[t.contain],"x"===S[t.notContain]?"y":"x"))):(n=p(o[0],o[1],"x"===S[0]?"y":"x"),a.forEach((function(e,t){var a=0===t?1:0;e.push(o[t]),o[t]=l(o[t],30,n>=60?c(o[t],o[a],"x"===S[t]?"y":"x"):"x"===S[t]?3:2)})))}else{if(h[0]&&h[1])return d(o[1],o[0])?a[1].push(o[1]):d(o[0],o[1])?a[0].push(o[0]):a[0].push("x"===S[0]?{x:o[1].x,y:o[0].y}:{x:o[0].x,y:o[1].y}),!1;h[0]!==h[1]?(t=u(h),a[t.notContain].push(o[t.notContain]),o[t.notContain]=l(o[t.notContain],30,p(o[t.notContain],o[t.contain],S[t.contain])>=30?c(o[t.notContain],o[t.contain],S[t.contain]):o[t.contain].dirId)):(i=[{x:o[0].x,y:o[0].y},{x:o[1].x,y:o[1].y}],a.forEach((function(e,t){var a=0===t?1:0,n=p(i[t],i[a],S[t]);n<30&&(o[t]=l(o[t],30-n)),e.push(o[t]),o[t]=l(o[t],30,c(o[t],o[a],S[a]))})))}return!0}for(v.forEach((function(e,n){var r,s=O(e),d=t[n];r=Array.isArray(d)?d[0]<0?[4,-d[0]]:d[0]>0?[2,d[0]]:d[1]<0?[1,-d[1]]:d[1]>0?[3,d[1]]:[e.socketId,0]:"number"!=typeof d?[e.socketId,30]:d>=0?[e.socketId,d]:[i(e.socketId),-d],s.dirId=r[0],d=r[1],a[n].push(s),o[n]=l(s,d)}));h(););a[1].reverse(),a[0].concat(a[1]).forEach((function(t,a){var o={x:t.x,y:t.y};a>0&&n.push([e,o]),e=o}))}()}s=[],w.position_plugOverheadSE.forEach((function(e,t){var o,i,r,l,d,u,p,c,h,S,f,g=!t;e>0?2===(o=n[i=g?0:n.length-1]).length?(s[i]=s[i]||ee.apply(null,o),s[i]>10&&(s[i]-e<10&&(e=s[i]-10),r=te(o[0],o[1],(g?e:s[i]-e)/s[i]),n[i]=g?[r,o[1]]:[o[0],r],s[i]-=e)):(s[i]=s[i]||ie.apply(null,o),s[i]>10&&(s[i]-e<10&&(e=s[i]-10),r=oe(o[0],o[1],o[2],o[3],re(o[0],o[1],o[2],o[3],g?e:s[i]-e)),g?(l=o[0],d=r.toP1):(l=o[3],d=r.fromP2),u=Math.atan2(l.y-r.y,r.x-l.x),p=ee(r,d),r.x=l.x+Math.cos(u)*e,r.y=l.y+Math.sin(u)*e*-1,d.x=r.x+Math.cos(u)*p,d.y=r.y+Math.sin(u)*p*-1,n[i]=g?[r,r.toP1,r.toP2,o[3]]:[o[0],r.fromP1,r.fromP2,r],s[i]=null)):e<0&&(o=n[i=g?0:n.length-1],c=v[t].socketId,h=4===c||2===c?"x":"y",e<(f=-a[t]["x"===h?"width":"height"])&&(e=f),S=e*(4===c||1===c?-1:1),2===o.length?o[g?0:o.length-1][h]+=S:(g?[0,1]:[o.length-2,o.length-1]).forEach((function(e){o[e][h]+=S})),s[i]=null)})),x.position_socketXYSE=U(v),x.position_plugOverheadSE=U(w.position_plugOverheadSE),x.position_path=w.position_path,x.position_lineStrokeWidth=w.position_lineStrokeWidth,x.position_socketGravitySE=U(t),L=!0,e.events.apl_position&&e.events.apl_position.forEach((function(t){t(e,n)}))}return L||traceLog.add("not-updated"),traceLog.add("</updatePosition>"),L}(t)),(a.path||n.position)&&(n.path=function(e){traceLog.add("<updatePath>");var t,a=e.curStats,n=e.aplStats,o=e.pathList.animVal||e.pathList.baseVal,i=a.path_edge,r=!1;return o&&(i.x1=i.x2=o[0][0].x,i.y1=i.y2=o[0][0].y,a.path_pathData=t=de(o,(function(e){e.x<i.x1&&(i.x1=e.x),e.y<i.y1&&(i.y1=e.y),e.x>i.x2&&(i.x2=e.x),e.y>i.y2&&(i.y2=e.y)})),ce(t,n.path_pathData)&&(traceLog.add("path_pathData"),e.linePath.setPathData(t),n.path_pathData=t,r=!0,T?(Ee(e,e.plugsFace),Ee(e,e.lineMaskCaps)):O&&Ee(e,e.linePath),e.events.apl_path&&e.events.apl_path.forEach((function(a){a(e,t)})))),r||traceLog.add("not-updated"),traceLog.add("</updatePath>"),r}(t)),n.viewBox=function(e){traceLog.add("<updateViewBox>");var t,a,n=e.curStats,o=e.aplStats,i=n.path_edge,r=n.viewBox_bBox,l=o.viewBox_bBox,s=e.svg.viewBox.baseVal,d=e.svg.style,u=!1;return t=Math.max(n.line_strokeWidth/2,n.viewBox_plugBCircleSE[0]||0,n.viewBox_plugBCircleSE[1]||0),a={x1:i.x1-t,y1:i.y1-t,x2:i.x2+t,y2:i.y2+t},e.events.new_edge4viewBox&&e.events.new_edge4viewBox.forEach((function(t){t(e,a)})),r.x=n.lineMask_x=n.lineOutlineMask_x=n.maskBGRect_x=a.x1,r.y=n.lineMask_y=n.lineOutlineMask_y=n.maskBGRect_y=a.y1,r.width=a.x2-a.x1,r.height=a.y2-a.y1,["x","y","width","height"].forEach((function(t){var a;(a=r[t])!==l[t]&&(traceLog.add(t),s[t]=l[t]=a,d[w[t]]=a+("x"===t||"y"===t?e.bodyOffset[t]:0)+"px",u=!0)})),u||traceLog.add("not-updated"),traceLog.add("</updateViewBox>"),u}(t),n.mask=function(e){traceLog.add("<updateMask>");var t,a=e.curStats,n=e.aplStats,o=!1;return a.plug_enabled?[0,1].forEach((function(e){a.capsMaskMarker_enabledSE[e]=a.plug_enabledSE[e]&&a.plug_colorTraSE[e]||a.plugOutline_enabledSE[e]&&a.plugOutline_colorTraSE[e]})):a.capsMaskMarker_enabledSE[0]=a.capsMaskMarker_enabledSE[1]=!1,a.capsMaskMarker_enabled=a.capsMaskMarker_enabledSE[0]||a.capsMaskMarker_enabledSE[1],a.lineMask_outlineMode=a.lineOutline_enabled,a.caps_enabled=a.capsMaskMarker_enabled||a.capsMaskAnchor_enabledSE[0]||a.capsMaskAnchor_enabledSE[1],a.lineMask_enabled=a.caps_enabled||a.lineMask_outlineMode,(a.lineMask_enabled&&!a.lineMask_outlineMode||a.lineOutline_enabled)&&["x","y"].forEach((function(i){var r="maskBGRect_"+i;ke(e,n,r,t=a[r],null,r+"%_")&&(e.maskBGRect[i].baseVal.value=t,o=!0)})),ke(e,n,"lineMask_enabled",t=a.lineMask_enabled)&&(e.lineFace.style.mask=t?"url(#"+e.lineMaskId+")":"none",o=!0,M&&Ee(e,e.lineMask)),a.lineMask_enabled&&(ke(e,n,"lineMask_outlineMode",t=a.lineMask_outlineMode)&&(t?(e.lineMaskBG.style.display="none",e.lineMaskShape.style.display="inline"):(e.lineMaskBG.style.display="inline",e.lineMaskShape.style.display="none"),o=!0),["x","y"].forEach((function(i){var r="lineMask_"+i;ke(e,n,r,t=a[r],null,r+"%_")&&(e.lineMask[i].baseVal.value=t,o=!0)})),ke(e,n,"caps_enabled",t=a.caps_enabled)&&(e.lineMaskCaps.style.display=e.lineOutlineMaskCaps.style.display=t?"inline":"none",o=!0,M&&Ee(e,e.capsMaskLine)),a.caps_enabled&&([0,1].forEach((function(i){var r;ke(e,n.capsMaskAnchor_enabledSE,i,t=a.capsMaskAnchor_enabledSE[i],null,"capsMaskAnchor_enabledSE["+i+"]=%s")&&(e.capsMaskAnchorSE[i].style.display=t?"inline":"none",o=!0,M&&Ee(e,e.lineMask)),a.capsMaskAnchor_enabledSE[i]&&(ce(r=a.capsMaskAnchor_pathDataSE[i],n.capsMaskAnchor_pathDataSE[i])&&(traceLog.add("capsMaskAnchor_pathDataSE["+i+"]"),e.capsMaskAnchorSE[i].setPathData(r),n.capsMaskAnchor_pathDataSE[i]=r,o=!0),ke(e,n.capsMaskAnchor_strokeWidthSE,i,t=a.capsMaskAnchor_strokeWidthSE[i],null,"capsMaskAnchor_strokeWidthSE["+i+"]=%s")&&(e.capsMaskAnchorSE[i].style.strokeWidth=t+"px",o=!0))})),ke(e,n,"capsMaskMarker_enabled",t=a.capsMaskMarker_enabled)&&(e.capsMaskLine.style.display=t?"inline":"none",o=!0),a.capsMaskMarker_enabled&&[0,1].forEach((function(i){var r=a.capsMaskMarker_plugSE[i],l="behind"!==r?E[m[r]]:null,s=_e(i,l);ke(e,n.capsMaskMarker_enabledSE,i,t=a.capsMaskMarker_enabledSE[i],null,"capsMaskMarker_enabledSE["+i+"]=%s")&&(e.capsMaskLine.style[s.prop]=t?"url(#"+e.lineMaskMarkerIdSE[i]+")":"none",o=!0),a.capsMaskMarker_enabledSE[i]&&(ke(e,n.capsMaskMarker_plugSE,i,r,null,"capsMaskMarker_plugSE["+i+"]=%s")&&(e.capsMaskMarkerShapeSE[i].href.baseVal="#"+l.elmId,me(e,e.capsMaskMarkerSE[i],s.orient,l.bBox,e.svg,e.capsMaskMarkerShapeSE[i],e.capsMaskLine),o=!0,O&&(Ee(e,e.capsMaskLine),Ee(e,e.lineFace))),["markerWidth","markerHeight"].forEach((function(r){var l="capsMaskMarker_"+r+"SE";ke(e,n[l],i,t=a[l][i],null,l+"["+i+"]%_")&&(e.capsMaskMarkerSE[i][r].baseVal.value=t,o=!0)})))})))),a.lineOutline_enabled&&["x","y"].forEach((function(i){var r="lineOutlineMask_"+i;ke(e,n,r,t=a[r],null,r+"%_")&&(e.lineOutlineMask[i].baseVal.value=t,o=!0)})),o||traceLog.add("not-updated"),traceLog.add("</updateMask>"),o}(t),a.effect&&function(t){traceLog.add("<setEffect>");var a,n=t.curStats,o=t.aplStats;Object.keys(e).forEach((function(i){var r=e[i],l=i+"_enabled",s=i+"_options",d=n[s];ke(t,o,l,a=n[l])?(a&&(o[s]=U(d)),r[a?"init":"remove"](t)):a&&Y(d,o[s])&&(r.remove(t),o[l]=!0,o[s]=U(d),r.init(t))})),traceLog.add("</setEffect>")}(t),(A||M)&&n.line&&!n.path&&Ee(t,t.lineShape),A&&n.plug&&!n.line&&Ee(t,t.plugsFace),ye(t),traceLog.add("<update>"),Object.keys(n).forEach((function(e){n[e]&&traceLog.add("updated."+e)})),traceLog.add("</update>")}function Ae(e,t){return{duration:P(e.duration)&&e.duration>0?e.duration:t.duration,timing:W.validTiming(e.timing)?e.timing:U(t.timing)}}function Me(e,a,n,o){var i,r=e.curStats,l=e.aplStats,s={};function d(){["show_on","show_effect","show_animOptions"].forEach((function(e){l[e]=r[e]}))}r.show_on=a,n&&t[n]&&(r.show_effect=n,r.show_animOptions=Ae(I(o)?o:{},t[n].defaultAnimOptions)),s.show_on=r.show_on!==l.show_on,s.show_effect=r.show_effect!==l.show_effect,s.show_animOptions=Y(r.show_animOptions,l.show_animOptions),s.show_effect||s.show_animOptions?r.show_inAnim?(i=s.show_effect?t[l.show_effect].stop(e,!0,!0):t[l.show_effect].stop(e),d(),t[l.show_effect].init(e,i)):s.show_on&&(l.show_effect&&s.show_effect&&t[l.show_effect].stop(e,!0,!0),d(),t[l.show_effect].init(e)):s.show_on&&(d(),t[l.show_effect].start(e)),traceLog.add("<show>"),Object.keys(s).forEach((function(e){s[e]&&traceLog.add("update."+e)})),traceLog.add("</show>")}function Ce(e,t,a){var n={props:e,optionName:a};return!(!(e.attachments.indexOf(t)<0)||t.conf.bind&&!t.conf.bind(t,n))&&(e.attachments.push(t),t.boundTargets.push(n),!0)}function Ne(e,t,a){var n=e.attachments.indexOf(t);n>-1&&e.attachments.splice(n,1),t.boundTargets.some((function(a,o){return a.props===e&&(t.conf.unbind&&t.conf.unbind(t,a),n=o,!0)}))&&(t.boundTargets.splice(n,1),a||fe((function(){t.boundTargets.length||i(t)})))}function Ie(t,i){var r,l,s=t.options,d={};function u(e,t,a,n,o){var i={};return a?null!=n?(i.container=e[a],i.key=n):(i.container=e,i.key=a):(i.container=e,i.key=t),i.default=o,i.acceptsAuto=null==i.default,i}function p(e,t,a,n,o,i,r){var l,s,d,p=u(e,a,o,i,r);return null!=t[a]&&(s=(t[a]+"").toLowerCase())&&(p.acceptsAuto&&"auto"===s||(d=n[s]))&&d!==p.container[p.key]&&(p.container[p.key]=d,l=!0),null!=p.container[p.key]||p.acceptsAuto||(p.container[p.key]=p.default,l=!0),l}function c(e,t,a,n,o,i,r,l,s){var d,p,c=u(e,a,o,i,r);if(!n){if(null==c.default)throw new Error("Invalid `type`: "+a);n=typeof c.default}return null!=t[a]&&(c.acceptsAuto&&"auto"===(t[a]+"").toLowerCase()||function(e,t){return"number"===t?P(e):typeof e===t}(p=t[a],n)&&(p=s&&"string"===n&&p?p.trim():p,1)&&(!l||l(p)))&&p!==c.container[c.key]&&(c.container[c.key]=p,d=!0),null!=c.container[c.key]||c.acceptsAuto||(c.container[c.key]=c.default,d=!0),d}if(i=i||{},["start","end"].forEach((function(e,a){var n=i[e],r=!1;if(n&&(Z(n)||(r=o(n,"anchor")))&&n!==s.anchorSE[a]){if(!1!==t.optionIsAttach.anchorSE[a]&&Ne(t,j[s.anchorSE[a]._id]),r&&!Ce(t,j[n._id],e))throw new Error("Can't bind attachment");s.anchorSE[a]=n,t.optionIsAttach.anchorSE[a]=r,l=d.position=!0}})),!s.anchorSE[0]||!s.anchorSE[1]||s.anchorSE[0]===s.anchorSE[1])throw new Error("`start` and `end` are required.");l&&(r=$(!1!==t.optionIsAttach.anchorSE[0]?j[s.anchorSE[0]._id].element:s.anchorSE[0],!1!==t.optionIsAttach.anchorSE[1]?j[s.anchorSE[1]._id].element:s.anchorSE[1]))!==t.baseWindow&&(Le(t,r),d.line=d.plug=d.lineOutline=d.plugOutline=d.faces=d.effect=!0),d.position=p(s,i,"path",f,null,null,N.path)||d.position,d.position=p(s,i,"startSocket",S,"socketSE",0)||d.position,d.position=p(s,i,"endSocket",S,"socketSE",1)||d.position,[i.startSocketGravity,i.endSocketGravity].forEach((function(e,t){var a,n,o=!1;null!=e&&(Array.isArray(e)?P(e[0])&&P(e[1])&&(o=[e[0],e[1]],Array.isArray(s.socketGravitySE[t])&&(a=o,n=s.socketGravitySE[t],a.length===n.length&&a.every((function(e,t){return e===n[t]})))&&(o=!1)):("auto"===(e+"").toLowerCase()?o=null:P(e)&&e>=0&&(o=e),o===s.socketGravitySE[t]&&(o=!1)),!1!==o&&(s.socketGravitySE[t]=o,d.position=!0))})),d.line=c(s,i,"color",null,"lineColor",null,N.lineColor,null,!0)||d.line,d.line=c(s,i,"size",null,"lineSize",null,N.lineSize,(function(e){return e>0}))||d.line,["startPlug","endPlug"].forEach((function(e,t){d.plug=p(s,i,e,y,"plugSE",t,N.plugSE[t])||d.plug,d.plug=c(s,i,e+"Color","string","plugColorSE",t,null,null,!0)||d.plug,d.plug=c(s,i,e+"Size",null,"plugSizeSE",t,N.plugSizeSE[t],(function(e){return e>0}))||d.plug})),d.lineOutline=c(s,i,"outline",null,"lineOutlineEnabled",null,N.lineOutlineEnabled)||d.lineOutline,d.lineOutline=c(s,i,"outlineColor",null,"lineOutlineColor",null,N.lineOutlineColor,null,!0)||d.lineOutline,d.lineOutline=c(s,i,"outlineSize",null,"lineOutlineSize",null,N.lineOutlineSize,(function(e){return e>0&&e<=.48}))||d.lineOutline,["startPlugOutline","endPlugOutline"].forEach((function(e,t){d.plugOutline=c(s,i,e,null,"plugOutlineEnabledSE",t,N.plugOutlineEnabledSE[t])||d.plugOutline,d.plugOutline=c(s,i,e+"Color","string","plugOutlineColorSE",t,null,null,!0)||d.plugOutline,d.plugOutline=c(s,i,e+"Size",null,"plugOutlineSizeSE",t,N.plugOutlineSizeSE[t],(function(e){return e>=1}))||d.plugOutline})),["startLabel","endLabel","middleLabel"].forEach((function(e,r){var l,d,u,p=i[e],c=s.labelSEM[r]&&!t.optionIsAttach.labelSEM[r]?j[s.labelSEM[r]._id].text:s.labelSEM[r],h=!1;if((l="string"==typeof p)&&(p=p.trim()),(l||p&&(h=o(p,"label")))&&p!==c){if(s.labelSEM[r]&&(Ne(t,j[s.labelSEM[r]._id]),s.labelSEM[r]=""),p){if(h?(d=j[(u=p)._id]).boundTargets.slice().forEach((function(e){d.conf.removeOption(d,e)})):u=new n(a.captionLabel,[p]),!Ce(t,j[u._id],e))throw new Error("Can't bind attachment");s.labelSEM[r]=u}t.optionIsAttach.labelSEM[r]=h}})),Object.keys(e).forEach((function(a){var n,o,r=e[a],l=a+"_enabled",u=a+"_options";function h(e){var t={};return r.optionsConf.forEach((function(a){var n=a[0],o=a[3];null==a[4]||t[o]||(t[o]=[]),("function"==typeof n?n:"id"===n?p:c).apply(null,[t,e].concat(a.slice(1)))})),t}function S(e){var n,o=a+"_animOptions";return e.hasOwnProperty("animation")?I(e.animation)?n=t.curStats[o]=Ae(e.animation,r.defaultAnimOptions):(n=!!e.animation,t.curStats[o]=n?Ae({},r.defaultAnimOptions):null):(n=!!r.defaultEnabled,t.curStats[o]=n?Ae({},r.defaultAnimOptions):null),n}i.hasOwnProperty(a)&&(n=i[a],I(n)?(t.curStats[l]=!0,o=t.curStats[u]=h(n),r.anim&&(t.curStats[u].animation=S(n))):(o=t.curStats[l]=!!n)&&(t.curStats[u]=h({}),r.anim&&(t.curStats[u].animation=S({}))),Y(o,s[a])&&(s[a]=o,d.effect=!0))})),traceLog.add("<setOptions>"),Object.keys(d).forEach((function(e){d[e]&&traceLog.add("needs."+e)})),traceLog.add("</setOptions>"),Oe(t,d)}function Pe(a,n,o){var i={options:{anchorSE:[],socketSE:[],socketGravitySE:[],plugSE:[],plugColorSE:[],plugSizeSE:[],plugOutlineEnabledSE:[],plugOutlineColorSE:[],plugOutlineSizeSE:[],labelSEM:["","",""]},optionIsAttach:{anchorSE:[!1,!1],labelSEM:[!1,!1,!1]},curStats:{},aplStats:{},attachments:[],events:{},reflowTargets:[]};we(i.curStats,F),we(i.aplStats,F),Object.keys(e).forEach((function(t){var a=e[t].stats;we(i.curStats,a),we(i.aplStats,a),i.options[t]=!1})),we(i.curStats,B),we(i.aplStats,B),i.curStats.show_effect="fade",i.curStats.show_animOptions=U(t.fade.defaultAnimOptions),Object.defineProperty(this,"_id",{value:++R}),i._id=this._id,D[this._id]=i,1===arguments.length&&(o=a,a=null),o=o||{},(a||n)&&(o=U(o),a&&(o.start=a),n&&(o.end=n)),i.isShown=i.aplStats.show_on=!o.hide,this.setOptions(o)}return window.insProps=D,window.insAttachProps=j,window.isObject=I,window.IS_TRIDENT=T,window.IS_BLINK=A,window.IS_GECKO=O,window.IS_EDGE=L,window.IS_WEBKIT=M,window.engineFlags=function(e){"boolean"==typeof e.IS_TRIDENT&&(window.IS_TRIDENT=T=e.IS_TRIDENT),"boolean"==typeof e.IS_BLINK&&(window.IS_BLINK=A=e.IS_BLINK),"boolean"==typeof e.IS_GECKO&&(window.IS_GECKO=O=e.IS_GECKO),"boolean"==typeof e.IS_EDGE&&(window.IS_EDGE=L=e.IS_EDGE),"boolean"==typeof e.IS_WEBKIT&&(window.IS_WEBKIT=M=e.IS_WEBKIT)},window.hasChanged=Y,window.copyTree=U,window.getAlpha=X,window.mouseEnterLeave=K,window.isElement=Z,window.getBBox=q,window.getBBoxNest=J,window.getCommonWindow=$,window.getPointsLength=ee,window.getPointOnLine=te,window.getIntersection=ae,window.extendLine=ne,window.getPointOnCubic=oe,window.getCubicLength=ie,window.getCubicT=re,window.getOffsetLine=le,window.getOffsetCubic=se,window.pathList2PathData=de,window.getAllPathDataLen=pe,window.pathDataHasChanged=ce,window.forceReflow=ge,window.newDropShadow=be,window.bindWindow=Le,e={dash:{stats:{dash_len:{},dash_gap:{},dash_maxOffset:{}},anim:!0,defaultAnimOptions:{duration:1e3,timing:"linear"},optionsConf:[["type","len","number",null,null,null,function(e){return e>0}],["type","gap","number",null,null,null,function(e){return e>0}]],init:function(t){traceLog.add("<EFFECTS.dash.init>"),he(t,"apl_line_strokeWidth",e.dash.update),t.lineFace.style.strokeDashoffset=0,e.dash.update(t),traceLog.add("</EFFECTS.dash.init>")},remove:function(t){traceLog.add("<EFFECTS.dash.remove>");var a=t.curStats;Se(t,"apl_line_strokeWidth",e.dash.update),a.dash_animId&&(W.remove(a.dash_animId),a.dash_animId=null),t.lineFace.style.strokeDasharray="none",t.lineFace.style.strokeDashoffset=0,we(t.aplStats,e.dash.stats),traceLog.add("</EFFECTS.dash.remove>")},update:function(e){traceLog.add("<EFFECTS.dash.update>");var t,a=e.curStats,n=e.aplStats,o=n.dash_options,i=!1;a.dash_len=o.len||2*n.line_strokeWidth,a.dash_gap=o.gap||n.line_strokeWidth,a.dash_maxOffset=a.dash_len+a.dash_gap,i=ke(e,n,"dash_len",a.dash_len)||i,(i=ke(e,n,"dash_gap",a.dash_gap)||i)&&(e.lineFace.style.strokeDasharray=n.dash_len+","+n.dash_gap),a.dash_animOptions?(i=ke(e,n,"dash_maxOffset",a.dash_maxOffset),n.dash_animOptions&&(i||Y(a.dash_animOptions,n.dash_animOptions))&&(traceLog.add("anim.remove"),a.dash_animId&&(t=W.stop(a.dash_animId),W.remove(a.dash_animId)),n.dash_animOptions=null),n.dash_animOptions||(traceLog.add("anim.add"),a.dash_animId=W.add((function(e){return(1-e)*n.dash_maxOffset+"px"}),(function(t){e.lineFace.style.strokeDashoffset=t}),a.dash_animOptions.duration,0,a.dash_animOptions.timing,!1,t),n.dash_animOptions=U(a.dash_animOptions))):n.dash_animOptions&&(traceLog.add("anim.remove"),a.dash_animId&&(W.remove(a.dash_animId),a.dash_animId=null),e.lineFace.style.strokeDashoffset=0,n.dash_animOptions=null),traceLog.add("</EFFECTS.dash.update>")}},gradient:{stats:{gradient_colorSE:{hasSE:!0},gradient_pointSE:{hasSE:!0,hasProps:!0}},optionsConf:[["type","startColor","string","colorSE",0,null,null,!0],["type","endColor","string","colorSE",1,null,null,!0]],init:function(t){traceLog.add("<EFFECTS.gradient.init>");var a,n=t.baseWindow.document,o=t.defs,i=h+"-"+t._id+"-gradient";t.efc_gradient_gradient=a=o.appendChild(n.createElementNS(v,"linearGradient")),a.id=i,a.gradientUnits.baseVal=SVGUnitTypes.SVG_UNIT_TYPE_USERSPACEONUSE,[a.x1,a.y1,a.x2,a.y2].forEach((function(e){e.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0)})),t.efc_gradient_stopSE=[0,1].map((function(e){var a=t.efc_gradient_gradient.appendChild(n.createElementNS(v,"stop"));try{a.offset.baseVal=e}catch(t){if(t.code!==DOMException.NO_MODIFICATION_ALLOWED_ERR)throw t;a.setAttribute("offset",e)}return a})),he(t,"cur_plug_colorSE",e.gradient.update),he(t,"apl_path",e.gradient.update),t.curStats.line_altColor=!0,t.lineFace.style.stroke="url(#"+i+")",e.gradient.update(t),traceLog.add("</EFFECTS.gradient.init>")},remove:function(t){traceLog.add("<EFFECTS.gradient.remove>"),t.efc_gradient_gradient&&(t.defs.removeChild(t.efc_gradient_gradient),t.efc_gradient_gradient=t.efc_gradient_stopSE=null),Se(t,"cur_plug_colorSE",e.gradient.update),Se(t,"apl_path",e.gradient.update),t.curStats.line_altColor=!1,t.lineFace.style.stroke=t.curStats.line_color,we(t.aplStats,e.gradient.stats),traceLog.add("</EFFECTS.gradient.remove>")},update:function(e){traceLog.add("<EFFECTS.gradient.update>");var t,a,n=e.curStats,o=e.aplStats,i=o.gradient_options,r=e.pathList.animVal||e.pathList.baseVal;[0,1].forEach((function(e){n.gradient_colorSE[e]=i.colorSE[e]||n.plug_colorSE[e]})),a=r[0][0],n.gradient_pointSE[0]={x:a.x,y:a.y},a=(t=r[r.length-1])[t.length-1],n.gradient_pointSE[1]={x:a.x,y:a.y},[0,1].forEach((function(t){var a;ke(e,o.gradient_colorSE,t,a=n.gradient_colorSE[t],null,"gradient_colorSE["+t+"]=%s")&&(M?(a=X(a),e.efc_gradient_stopSE[t].style.stopColor=a[1],e.efc_gradient_stopSE[t].style.stopOpacity=a[0]):e.efc_gradient_stopSE[t].style.stopColor=a),["x","y"].forEach((function(i){(a=n.gradient_pointSE[t][i])!==o.gradient_pointSE[t][i]&&(traceLog.add("gradient_pointSE["+t+"]."+i),e.efc_gradient_gradient[i+(t+1)].baseVal.value=o.gradient_pointSE[t][i]=a)}))})),traceLog.add("</EFFECTS.gradient.update>")}},dropShadow:{stats:{dropShadow_dx:{},dropShadow_dy:{},dropShadow_blur:{},dropShadow_color:{},dropShadow_opacity:{},dropShadow_x:{},dropShadow_y:{}},optionsConf:[["type","dx",null,null,null,2],["type","dy",null,null,null,4],["type","blur",null,null,null,3,function(e){return e>=0}],["type","color",null,null,null,"#000",null,!0],["type","opacity",null,null,null,.8,function(e){return e>=0&&e<=1}]],init:function(t){traceLog.add("<EFFECTS.dropShadow.init>");var a=t.baseWindow.document,n=t.defs,o=h+"-"+t._id+"-dropShadow",i=be(a,o);["elmFilter","elmOffset","elmBlur","styleFlood","elmsAppend"].forEach((function(e){t["efc_dropShadow_"+e]=i[e]})),i.elmsAppend.forEach((function(e){n.appendChild(e)})),t.face.setAttribute("filter","url(#"+o+")"),he(t,"new_edge4viewBox",e.dropShadow.adjustEdge),e.dropShadow.update(t),traceLog.add("</EFFECTS.dropShadow.init>")},remove:function(t){traceLog.add("<EFFECTS.dropShadow.remove>");var a=t.defs;t.efc_dropShadow_elmsAppend&&(t.efc_dropShadow_elmsAppend.forEach((function(e){a.removeChild(e)})),t.efc_dropShadow_elmFilter=t.efc_dropShadow_elmOffset=t.efc_dropShadow_elmBlur=t.efc_dropShadow_styleFlood=t.efc_dropShadow_elmsAppend=null),Se(t,"new_edge4viewBox",e.dropShadow.adjustEdge),Oe(t,{}),t.face.removeAttribute("filter"),we(t.aplStats,e.dropShadow.stats),traceLog.add("</EFFECTS.dropShadow.remove>")},update:function(e){traceLog.add("<EFFECTS.dropShadow.update>");var t,a,n=e.curStats,o=e.aplStats,i=o.dropShadow_options;n.dropShadow_dx=t=i.dx,ke(e,o,"dropShadow_dx",t)&&(e.efc_dropShadow_elmOffset.dx.baseVal=t,a=!0),n.dropShadow_dy=t=i.dy,ke(e,o,"dropShadow_dy",t)&&(e.efc_dropShadow_elmOffset.dy.baseVal=t,a=!0),n.dropShadow_blur=t=i.blur,ke(e,o,"dropShadow_blur",t)&&(e.efc_dropShadow_elmBlur.setStdDeviation(t,t),a=!0),a&&Oe(e,{}),n.dropShadow_color=t=i.color,ke(e,o,"dropShadow_color",t)&&(e.efc_dropShadow_styleFlood.floodColor=t),n.dropShadow_opacity=t=i.opacity,ke(e,o,"dropShadow_opacity",t)&&(e.efc_dropShadow_styleFlood.floodOpacity=t),traceLog.add("</EFFECTS.dropShadow.update>")},adjustEdge:function(e,t){traceLog.add("<EFFECTS.dropShadow.adjustEdge>");var a,n,o=e.curStats,i=e.aplStats;null!=o.dropShadow_dx&&(a=3*o.dropShadow_blur,(n={x1:t.x1-a+o.dropShadow_dx,y1:t.y1-a+o.dropShadow_dy,x2:t.x2+a+o.dropShadow_dx,y2:t.y2+a+o.dropShadow_dy}).x1<t.x1&&(t.x1=n.x1),n.y1<t.y1&&(t.y1=n.y1),n.x2>t.x2&&(t.x2=n.x2),n.y2>t.y2&&(t.y2=n.y2),["x","y"].forEach((function(a){var n,r="dropShadow_"+a;o[r]=n=t[a+"1"],ke(e,i,r,n)&&(e.efc_dropShadow_elmFilter[a].baseVal.value=n)}))),traceLog.add("</EFFECTS.dropShadow.adjustEdge>")}}},window.EFFECTS=e,Object.keys(e).forEach((function(t){var a=e[t],n=a.stats;n[t+"_enabled"]={iniValue:!1},n[t+"_options"]={hasProps:!0},a.anim&&(n[t+"_animOptions"]={},n[t+"_animId"]={})})),t={none:{defaultAnimOptions:{},init:function(e,a){traceLog.add("<SHOW_EFFECTS.none.init>");var n=e.curStats;n.show_animId&&(W.remove(n.show_animId),n.show_animId=null),t.none.start(e,a),traceLog.add("</SHOW_EFFECTS.none.init>")},start:function(e,a){traceLog.add("<SHOW_EFFECTS.none.start>"),traceLog.add("timeRatio="+(null!=a?"timeRatio":"NONE")),t.none.stop(e,!0),traceLog.add("</SHOW_EFFECTS.none.start>")},stop:function(e,t,a){traceLog.add("<SHOW_EFFECTS.none.stop>"),traceLog.add("finish="+t);var n="on="+(null!=a?"on":"aplStats.show_on"),o=e.curStats;return a=null!=a?a:e.aplStats.show_on,traceLog.add(n+"="+a),o.show_inAnim=!1,t&&Te(e,a),traceLog.add("</SHOW_EFFECTS.none.stop>"),a?1:0}},fade:{defaultAnimOptions:{duration:300,timing:"linear"},init:function(e,a){traceLog.add("<SHOW_EFFECTS.fade.init>");var n=e.curStats,o=e.aplStats;n.show_animId&&W.remove(n.show_animId),n.show_animId=W.add((function(e){return e}),(function(a,n){n?t.fade.stop(e,!0):(e.svg.style.opacity=a+"",T&&(Ee(e,e.svg),ye(e)))}),o.show_animOptions.duration,1,o.show_animOptions.timing,null,!1),t.fade.start(e,a),traceLog.add("</SHOW_EFFECTS.fade.init>")},start:function(e,t){traceLog.add("<SHOW_EFFECTS.fade.start>");var a,n=e.curStats;n.show_inAnim&&(a=W.stop(n.show_animId)),Te(e,1),traceLog.add("timeRatio="+(null!=t?"timeRatio":null!=a?"prevTimeRatio":"NONE")),n.show_inAnim=!0,W.start(n.show_animId,!e.aplStats.show_on,null!=t?t:a),traceLog.add("</SHOW_EFFECTS.fade.start>")},stop:function(e,t,a){traceLog.add("<SHOW_EFFECTS.fade.stop>"),traceLog.add("finish="+t);var n,o="on="+(null!=a?"on":"aplStats.show_on"),i=e.curStats;return a=null!=a?a:e.aplStats.show_on,traceLog.add(o+"="+a),n=i.show_inAnim?W.stop(i.show_animId):a?1:0,i.show_inAnim=!1,t&&(e.svg.style.opacity=a?"":"0",Te(e,a)),traceLog.add("</SHOW_EFFECTS.fade.stop>"),n}},draw:{defaultAnimOptions:{duration:500,timing:[.58,0,.42,1]},init:function(e,a){traceLog.add("<SHOW_EFFECTS.draw.init>");var n=e.curStats,o=e.aplStats,i=e.pathList.baseVal,r=ue(i),l=r.segsLen,s=r.lenAll;n.show_animId&&W.remove(n.show_animId),n.show_animId=W.add((function(e){var t,a,n,o,r=-1;if(0===e)a=[[i[0][0],i[0][0]]];else if(1===e)a=i;else{for(t=s*e,a=[];t>=l[++r];)a.push(i[r]),t-=l[r];t&&(2===(n=i[r]).length?a.push([n[0],te(n[0],n[1],t/l[r])]):(o=oe(n[0],n[1],n[2],n[3],re(n[0],n[1],n[2],n[3],t)),a.push([n[0],o.fromP1,o.fromP2,o])))}return a}),(function(a,n){n?t.draw.stop(e,!0):(e.pathList.animVal=a,Oe(e,{path:!0}))}),o.show_animOptions.duration,1,o.show_animOptions.timing,null,!1),t.draw.start(e,a),traceLog.add("</SHOW_EFFECTS.draw.init>")},start:function(e,a){traceLog.add("<SHOW_EFFECTS.draw.start>");var n,o=e.curStats;o.show_inAnim&&(n=W.stop(o.show_animId)),Te(e,1),traceLog.add("timeRatio="+(null!=a?"timeRatio":null!=n?"prevTimeRatio":"NONE")),o.show_inAnim=!0,he(e,"apl_position",t.draw.update),W.start(o.show_animId,!e.aplStats.show_on,null!=a?a:n),traceLog.add("</SHOW_EFFECTS.draw.start>")},stop:function(e,t,a){traceLog.add("<SHOW_EFFECTS.draw.stop>"),traceLog.add("finish="+t);var n,o="on="+(null!=a?"on":"aplStats.show_on"),i=e.curStats;return a=null!=a?a:e.aplStats.show_on,traceLog.add(o+"="+a),n=i.show_inAnim?W.stop(i.show_animId):a?1:0,i.show_inAnim=!1,t&&(a?(e.pathList.animVal=null,Oe(e,{path:!0})):(e.pathList.animVal=[[e.pathList.baseVal[0][0],e.pathList.baseVal[0][0]]],Oe(e,{path:!0})),Te(e,a)),traceLog.add("</SHOW_EFFECTS.draw.stop>"),n},update:function(e){Se(e,"apl_position",t.draw.update),e.curStats.show_inAnim?t.draw.init(e,t.draw.stop(e)):e.aplStats.show_animOptions={}}}},window.SHOW_EFFECTS=t,function(){function t(e){return function(t){var a={};a[e]=t,this.setOptions(a)}}[["start","anchorSE",0],["end","anchorSE",1],["color","lineColor"],["size","lineSize"],["startSocketGravity","socketGravitySE",0],["endSocketGravity","socketGravitySE",1],["startPlugColor","plugColorSE",0],["endPlugColor","plugColorSE",1],["startPlugSize","plugSizeSE",0],["endPlugSize","plugSizeSE",1],["outline","lineOutlineEnabled"],["outlineColor","lineOutlineColor"],["outlineSize","lineOutlineSize"],["startPlugOutline","plugOutlineEnabledSE",0],["endPlugOutline","plugOutlineEnabledSE",1],["startPlugOutlineColor","plugOutlineColorSE",0],["endPlugOutlineColor","plugOutlineColorSE",1],["startPlugOutlineSize","plugOutlineSizeSE",0],["endPlugOutlineSize","plugOutlineSizeSE",1]].forEach((function(e){var a=e[0],n=e[1],o=e[2];Object.defineProperty(Pe.prototype,a,{get:function(){var e=null!=o?D[this._id].options[n][o]:n?D[this._id].options[n]:D[this._id].options[a];return null==e?"auto":U(e)},set:t(a),enumerable:!0})})),[["path",f],["startSocket",S,"socketSE",0],["endSocket",S,"socketSE",1],["startPlug",y,"plugSE",0],["endPlug",y,"plugSE",1]].forEach((function(e){var a=e[0],n=e[1],o=e[2],i=e[3];Object.defineProperty(Pe.prototype,a,{get:function(){var e,t=null!=i?D[this._id].options[o][i]:o?D[this._id].options[o]:D[this._id].options[a];return t?Object.keys(n).some((function(a){return n[a]===t&&(e=a,!0)}))?e:new Error("It's broken"):"auto"},set:t(a),enumerable:!0})})),Object.keys(e).forEach((function(a){var n=e[a];Object.defineProperty(Pe.prototype,a,{get:function(){var e,t,o=D[this._id].options[a];return I(o)?(e=o,t=n.optionsConf.reduce((function(t,a){var n,o=a[0],i=a[1],r=a[2],l=a[3],s=a[4],d=null!=s?e[l][s]:l?e[l]:e[i];return t[i]="id"===o?d?Object.keys(r).some((function(e){return r[e]===d&&(n=e,!0)}))?n:new Error("It's broken"):"auto":null==d?"auto":U(d),t}),{}),n.anim&&(t.animation=U(e.animation)),t):o},set:t(a),enumerable:!0})})),["startLabel","endLabel","middleLabel"].forEach((function(e,a){Object.defineProperty(Pe.prototype,e,{get:function(){var e=D[this._id],t=e.options;return t.labelSEM[a]&&!e.optionIsAttach.labelSEM[a]?j[t.labelSEM[a]._id].text:t.labelSEM[a]||""},set:t(e),enumerable:!0})}))}(),Pe.prototype.setOptions=function(e){return Ie(D[this._id],e),this},Pe.prototype.position=function(){return Oe(D[this._id],{position:!0}),this},Pe.prototype.remove=function(){var t=D[this._id],a=t.curStats;Object.keys(e).forEach((function(e){var t=e+"_animId";a[t]&&W.remove(a[t])})),a.show_animId&&W.remove(a.show_animId),t.attachments.slice().forEach((function(e){Ne(t,e)})),t.baseWindow&&t.svg&&t.baseWindow.document.body.removeChild(t.svg),delete D[this._id]},Pe.prototype.show=function(e,t){return Me(D[this._id],!0,e,t),this},Pe.prototype.hide=function(e,t){return Me(D[this._id],!1,e,t),this},i=function(e){traceLog.add("<removeAttachment>"),e&&j[e._id]?(e.boundTargets.slice().forEach((function(t){Ne(t.props,e,!0)})),e.conf.remove&&e.conf.remove(e),delete j[e._id]):traceLog.add("not-found"),traceLog.add("</removeAttachment>")},n=function(){function e(e,t){var a,n={conf:e,curStats:{},aplStats:{},boundTargets:[]},o={};e.argOptions.every((function(e){return!(!t.length||!("string"==typeof e.type?typeof t[0]===e.type:"function"==typeof e.type&&e.type(t[0])))&&(o[e.optionName]=t.shift(),!0)})),a=t.length&&I(t[0])?U(t[0]):{},Object.keys(o).forEach((function(e){a[e]=o[e]})),e.stats&&(we(n.curStats,e.stats),we(n.aplStats,e.stats)),Object.defineProperty(this,"_id",{value:++z}),Object.defineProperty(this,"isRemoved",{get:function(){return!j[this._id]}}),n._id=this._id,e.init&&!e.init(n,a)||(j[this._id]=n)}return e.prototype.remove=function(){traceLog.add("<LeaderLineAttachment.remove>");var e=this,t=j[e._id];t&&(t.boundTargets.slice().forEach((function(e){t.conf.removeOption(t,e)})),fe((function(){var t=j[e._id];traceLog.add("<LeaderLineAttachment.remove.delayedProc>"),t&&(traceLog.add("error-not-removed"),console.error("LeaderLineAttachment was not removed by removeOption"),i(t)),traceLog.add("</LeaderLineAttachment.remove.delayedProc>")}))),traceLog.add("</LeaderLineAttachment.remove>")},e}(),window.LeaderLineAttachment=n,o=function(e,t){return e instanceof n&&(!(e.isRemoved||t&&j[e._id].conf.type!==t)||null)},a={pointAnchor:{type:"anchor",argOptions:[{optionName:"element",type:Z}],init:function(e,t){return traceLog.add("<ATTACHMENTS.pointAnchor.init>"),e.element=a.pointAnchor.checkElement(t.element),e.x=a.pointAnchor.parsePercent(t.x,!0)||[.5,!0],e.y=a.pointAnchor.parsePercent(t.y,!0)||[.5,!0],traceLog.add("</ATTACHMENTS.pointAnchor.init>"),!0},removeOption:function(e,t){traceLog.add("<ATTACHMENTS.pointAnchor.removeOption>"),traceLog.add("optionName=%s",t.optionName);var o=t.props,i={},r=e.element,l=o.options.anchorSE["start"===t.optionName?1:0];r===l&&(r=l===document.body?new n(a.pointAnchor,[r]):document.body),i[t.optionName]=r,Ie(o,i),traceLog.add("</ATTACHMENTS.pointAnchor.removeOption>")},getBBoxNest:function(e,t){var a=J(e.element,t.baseWindow),n=a.width,o=a.height;return a.width=a.height=0,a.left=a.right=a.left+e.x[0]*(e.x[1]?n:1),a.top=a.bottom=a.top+e.y[0]*(e.y[1]?o:1),a},parsePercent:function(e,t){var a,n,o=!1;return P(e)?n=e:"string"==typeof e&&(a=x.exec(e))&&a[2]&&(o=0!==(n=parseFloat(a[1])/100)),null!=n&&(t||n>=0)?[n,o]:null},checkElement:function(e){if(null==e)e=document.body;else if(!Z(e))throw new Error("`element` must be Element");return e}},areaAnchor:{type:"anchor",argOptions:[{optionName:"element",type:Z},{optionName:"shape",type:"string"}],stats:{color:{},strokeWidth:{},elementWidth:{},elementHeight:{},elementLeft:{},elementTop:{},pathListRel:{},bBoxRel:{},pathData:{},viewBoxBBox:{hasProps:!0},dashLen:{},dashGap:{}},init:function(e,t){traceLog.add("<ATTACHMENTS.areaAnchor.init>");var n,o,i,r=[];return e.element=a.pointAnchor.checkElement(t.element),"string"==typeof t.color&&(e.color=t.color.trim()),"string"==typeof t.fillColor&&(e.fill=t.fillColor.trim()),P(t.size)&&t.size>=0&&(e.size=t.size),t.dash&&(e.dash=!0,P(t.dash.len)&&t.dash.len>0&&(e.dashLen=t.dash.len),P(t.dash.gap)&&t.dash.gap>0&&(e.dashGap=t.dash.gap)),"circle"===t.shape?e.shape=t.shape:"polygon"===t.shape&&Array.isArray(t.points)&&t.points.length>=3&&t.points.every((function(t){var n={};return!(!(n.x=a.pointAnchor.parsePercent(t[0],!0))||!(n.y=a.pointAnchor.parsePercent(t[1],!0)))&&(r.push(n),(n.x[1]||n.y[1])&&(e.hasRatio=!0),!0)}))?(e.shape=t.shape,e.points=r):(e.shape="rect",e.radius=P(t.radius)&&t.radius>=0?t.radius:0),"rect"!==e.shape&&"circle"!==e.shape||(e.x=a.pointAnchor.parsePercent(t.x,!0)||[-.05,!0],e.y=a.pointAnchor.parsePercent(t.y,!0)||[-.05,!0],e.width=a.pointAnchor.parsePercent(t.width)||[1.1,!0],e.height=a.pointAnchor.parsePercent(t.height)||[1.1,!0],(e.x[1]||e.y[1]||e.width[1]||e.height[1])&&(e.hasRatio=!0)),n=e.element.ownerDocument,e.svg=o=n.createElementNS(v,"svg"),o.className.baseVal=h+"-areaAnchor",o.viewBox.baseVal||o.setAttribute("viewBox","0 0 0 0"),e.path=o.appendChild(n.createElementNS(v,"path")),e.path.style.fill=e.fill||"none",e.isShown=!1,o.style.visibility="hidden",n.body.appendChild(o),ve(i=n.defaultView),e.bodyOffset=xe(i),e.updateColor=function(){traceLog.add("<ATTACHMENTS.areaAnchor.updateColor>");var t,a=e.curStats,n=e.aplStats,o=e.boundTargets.length?e.boundTargets[0].props.curStats:null;a.color=t=e.color||(o?o.line_color:N.lineColor),ke(e,n,"color",t)&&(e.path.style.stroke=t),traceLog.add("</ATTACHMENTS.areaAnchor.updateColor>")},e.updateShow=function(){Te(e,e.boundTargets.some((function(e){return!0===e.props.isShown})))},traceLog.add("</ATTACHMENTS.areaAnchor.init>"),!0},bind:function(e,t){traceLog.add("<ATTACHMENTS.areaAnchor.bind>");var a=t.props;return e.color||he(a,"cur_line_color",e.updateColor),he(a,"svgShow",e.updateShow),fe((function(){e.updateColor(),e.updateShow()})),traceLog.add("</ATTACHMENTS.areaAnchor.bind>"),!0},unbind:function(e,t){traceLog.add("<ATTACHMENTS.areaAnchor.unbind>");var n=t.props;e.color||Se(n,"cur_line_color",e.updateColor),Se(n,"svgShow",e.updateShow),e.boundTargets.length>1&&fe((function(){traceLog.add("<ATTACHMENTS.areaAnchor.unbind.delayedProc>"),e.updateColor(),e.updateShow(),a.areaAnchor.update(e)&&(traceLog.add("update-boundTargets"),e.boundTargets.forEach((function(e){Oe(e.props,{position:!0})}))),traceLog.add("</ATTACHMENTS.areaAnchor.unbind.delayedProc>")})),traceLog.add("</ATTACHMENTS.areaAnchor.unbind>")},removeOption:function(e,t){a.pointAnchor.removeOption(e,t)},remove:function(e){traceLog.add("<ATTACHMENTS.areaAnchor.remove>"),e.boundTargets.length&&(traceLog.add("error-not-unbound"),console.error("LeaderLineAttachment was not unbound by remove"),e.boundTargets.forEach((function(t){a.areaAnchor.unbind(e,t)}))),e.svg.parentNode.removeChild(e.svg),traceLog.add("</ATTACHMENTS.areaAnchor.remove>")},getStrokeWidth:function(e,t){return traceLog.add("<ATTACHMENTS.areaAnchor.getStrokeWidth>"),a.areaAnchor.update(e)&&e.boundTargets.length>1&&(traceLog.add("update-boundTargets"),fe((function(){e.boundTargets.forEach((function(e){e.props!==t&&Oe(e.props,{position:!0})}))}))),traceLog.add("</ATTACHMENTS.areaAnchor.getStrokeWidth>"),e.curStats.strokeWidth},getPathData:function(e,t){var a=J(e.element,t.baseWindow);return de(e.curStats.pathListRel,(function(e){e.x+=a.left,e.y+=a.top}))},getBBoxNest:function(e,t){var a=J(e.element,t.baseWindow),n=e.curStats.bBoxRel;return{left:n.left+a.left,top:n.top+a.top,right:n.right+a.left,bottom:n.bottom+a.top,width:n.width,height:n.height}},update:function(e){traceLog.add("<ATTACHMENTS.areaAnchor.update>");var t,a,n,o,i,r,l,s,d,u,p,c,h,S,f,g=e.curStats,E=e.aplStats,y=e.boundTargets.length?e.boundTargets[0].props.curStats:null,m={};if(m.strokeWidth=ke(e,g,"strokeWidth",null!=e.size?e.size:y?y.line_strokeWidth:N.lineSize),t=q(e.element),m.elementWidth=ke(e,g,"elementWidth",t.width),m.elementHeight=ke(e,g,"elementHeight",t.height),m.elementLeft=ke(e,g,"elementLeft",t.left),m.elementTop=ke(e,g,"elementTop",t.top),m.strokeWidth||e.hasRatio&&(m.elementWidth||m.elementHeight)){switch(traceLog.add("generate-path"),e.shape){case"rect":(n={left:e.x[0]*(e.x[1]?t.width:1),top:e.y[0]*(e.y[1]?t.height:1),width:e.width[0]*(e.width[1]?t.width:1),height:e.height[0]*(e.height[1]?t.height:1)}).right=n.left+n.width,n.bottom=n.top+n.height,l=g.strokeWidth/2,i=(r=Math.min(n.width,n.height))?r/2*Math.SQRT2+l:0,(o=e.radius?e.radius<=i?e.radius:i:0)?(d=o-(s=(o-l)/Math.SQRT2),p=.5522847*o,u=[{x:n.left-d,y:n.top+s},{x:n.left+s,y:n.top-d},{x:n.right-s,y:n.top-d},{x:n.right+d,y:n.top+s},{x:n.right+d,y:n.bottom-s},{x:n.right-s,y:n.bottom+d},{x:n.left+s,y:n.bottom+d},{x:n.left-d,y:n.bottom-s}],g.pathListRel=[[u[0],{x:u[0].x,y:u[0].y-p},{x:u[1].x-p,y:u[1].y},u[1]]],u[1].x!==u[2].x&&g.pathListRel.push([u[1],u[2]]),g.pathListRel.push([u[2],{x:u[2].x+p,y:u[2].y},{x:u[3].x,y:u[3].y-p},u[3]]),u[3].y!==u[4].y&&g.pathListRel.push([u[3],u[4]]),g.pathListRel.push([u[4],{x:u[4].x,y:u[4].y+p},{x:u[5].x+p,y:u[5].y},u[5]]),u[5].x!==u[6].x&&g.pathListRel.push([u[5],u[6]]),g.pathListRel.push([u[6],{x:u[6].x-p,y:u[6].y},{x:u[7].x,y:u[7].y+p},u[7]]),u[7].y!==u[0].y&&g.pathListRel.push([u[7],u[0]]),g.pathListRel.push([]),d=o-s+g.strokeWidth/2,u=[{x:n.left-d,y:n.top-d},{x:n.right+d,y:n.bottom+d}],g.bBoxRel={left:u[0].x,top:u[0].y,right:u[1].x,bottom:u[1].y,width:u[1].x-u[0].x,height:u[1].y-u[0].y}):(d=g.strokeWidth/2,u=[{x:n.left-d,y:n.top-d},{x:n.right+d,y:n.bottom+d}],g.pathListRel=[[u[0],{x:u[1].x,y:u[0].y}],[{x:u[1].x,y:u[0].y},u[1]],[u[1],{x:u[0].x,y:u[1].y}],[]],u=[{x:n.left-g.strokeWidth,y:n.top-g.strokeWidth},{x:n.right+g.strokeWidth,y:n.bottom+g.strokeWidth}],g.bBoxRel={left:u[0].x,top:u[0].y,right:u[1].x,bottom:u[1].y,width:u[1].x-u[0].x,height:u[1].y-u[0].y});break;case"circle":!function(){var a,n,o,i,r,l,s,d,u,p,c,h,S;(a={left:e.x[0]*(e.x[1]?t.width:1),top:e.y[0]*(e.y[1]?t.height:1),width:e.width[0]*(e.width[1]?t.width:1),height:e.height[0]*(e.height[1]?t.height:1)}).width||a.height||(a.width=a.height=10),a.width||(a.width=a.height),a.height||(a.height=a.width),a.right=a.left+a.width,a.bottom=a.top+a.height,n=a.left+a.width/2,o=a.top+a.height/2,d=g.strokeWidth/2,u=a.width/2,p=a.height/2,l=.5522847*(i=u*Math.SQRT2+d),s=.5522847*(r=p*Math.SQRT2+d),S=[{x:n-i,y:o},{x:n,y:o-r},{x:n+i,y:o},{x:n,y:o+r}],g.pathListRel=[[S[0],{x:S[0].x,y:S[0].y-s},{x:S[1].x-l,y:S[1].y},S[1]],[S[1],{x:S[1].x+l,y:S[1].y},{x:S[2].x,y:S[2].y-s},S[2]],[S[2],{x:S[2].x,y:S[2].y+s},{x:S[3].x+l,y:S[3].y},S[3]],[S[3],{x:S[3].x-l,y:S[3].y},{x:S[0].x,y:S[0].y+s},S[0]],[]],c=i-u+g.strokeWidth/2,h=r-p+g.strokeWidth/2,S=[{x:a.left-c,y:a.top-h},{x:a.right+c,y:a.bottom+h}],g.bBoxRel={left:S[0].x,top:S[0].y,right:S[1].x,bottom:S[1].y,width:S[1].x-S[0].x,height:S[1].y-S[0].y}}();break;case"polygon":!function(){var a,n,o,i;e.points.forEach((function(e){var o=e.x[0]*(e.x[1]?t.width:1),i=e.y[0]*(e.y[1]?t.height:1);a?(o<a.left&&(a.left=o),o>a.right&&(a.right=o),i<a.top&&(a.top=i),i>a.bottom&&(a.bottom=i)):a={left:o,right:o,top:i,bottom:i},n?g.pathListRel.push([n,{x:o,y:i}]):g.pathListRel=[],n={x:o,y:i}})),g.pathListRel.push([]),o=g.strokeWidth/2,i=[{x:a.left-o,y:a.top-o},{x:a.right+o,y:a.bottom+o}],g.bBoxRel={left:i[0].x,top:i[0].y,right:i[1].x,bottom:i[1].y,width:i[1].x-i[0].x,height:i[1].y-i[0].y}}()}m.pathListRel=m.bBoxRel=!0}return(m.pathListRel||m.elementLeft||m.elementTop)&&(g.pathData=de(g.pathListRel,(function(e){e.x+=t.left,e.y+=t.top}))),ke(e,E,"strokeWidth",a=g.strokeWidth)&&(e.path.style.strokeWidth=a+"px"),ce(a=g.pathData,E.pathData)&&(traceLog.add("pathData"),e.path.setPathData(a),E.pathData=a,m.pathData=!0),e.dash&&(!m.pathData&&(!m.strokeWidth||e.dashLen&&e.dashGap)||(g.dashLen=e.dashLen||2*g.strokeWidth,g.dashGap=e.dashGap||g.strokeWidth),m.dash=ke(e,E,"dashLen",g.dashLen)||m.dash,m.dash=ke(e,E,"dashGap",g.dashGap)||m.dash,m.dash&&(e.path.style.strokeDasharray=E.dashLen+","+E.dashGap)),c=g.viewBoxBBox,h=E.viewBoxBBox,S=e.svg.viewBox.baseVal,f=e.svg.style,c.x=g.bBoxRel.left+t.left,c.y=g.bBoxRel.top+t.top,c.width=g.bBoxRel.width,c.height=g.bBoxRel.height,["x","y","width","height"].forEach((function(t){(a=c[t])!==h[t]&&(traceLog.add(t),S[t]=h[t]=a,f[w[t]]=a+("x"===t||"y"===t?e.bodyOffset[t]:0)+"px")})),traceLog.add("</ATTACHMENTS.areaAnchor.update>"),m.strokeWidth||m.pathListRel||m.bBoxRel}},mouseHoverAnchor:{type:"anchor",argOptions:[{optionName:"element",type:Z},{optionName:"showEffectName",type:"string"}],style:{backgroundImage:"url('data:image/svg+xml;charset=utf-8;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cG9seWdvbiBwb2ludHM9IjI0LDAgMCw4IDgsMTEgMCwxOSA1LDI0IDEzLDE2IDE2LDI0IiBmaWxsPSJjb3JhbCIvPjwvc3ZnPg==')",backgroundSize:"",backgroundRepeat:"no-repeat",backgroundColor:"#f8f881",cursor:"default"},hoverStyle:{backgroundImage:"none",backgroundColor:"#fadf8f"},padding:{top:1,right:15,bottom:1,left:2},minHeight:15,backgroundPosition:{right:2,top:2},backgroundSize:{width:12,height:12},dirKeys:[["top","Top"],["right","Right"],["bottom","Bottom"],["left","Left"]],init:function(e,n){traceLog.add("<ATTACHMENTS.mouseHoverAnchor.init>");var o,i,r,l,s,d,u,p,c,h,S,f=a.mouseHoverAnchor,g={};if(e.element=a.pointAnchor.checkElement(n.element),p=e.element,!((h=p.ownerDocument)&&(c=h.defaultView)&&c.HTMLElement&&p instanceof c.HTMLElement))throw new Error("`element` must be HTML element");return f.style.backgroundSize=f.backgroundSize.width+"px "+f.backgroundSize.height+"px",["style","hoverStyle"].forEach((function(t){var a=f[t];e[t]=Object.keys(a).reduce((function(e,t){return e[t]=a[t],e}),{})})),"inline"===(o=e.element.ownerDocument.defaultView.getComputedStyle(e.element,"")).display?e.style.display="inline-block":"none"===o.display&&(e.style.display="block"),a.mouseHoverAnchor.dirKeys.forEach((function(t){var a=t[0],n="padding"+t[1];parseFloat(o[n])<f.padding[a]&&(e.style[n]=f.padding[a]+"px")})),e.style.display&&(l=e.element.style.display,e.element.style.display=e.style.display),a.mouseHoverAnchor.dirKeys.forEach((function(t){var a="padding"+t[1];e.style[a]&&(g[a]=e.element.style[a],e.element.style[a]=e.style[a])})),(r=e.element.getBoundingClientRect()).height<f.minHeight&&(T?(S=f.minHeight,"content-box"===o.boxSizing?S-=parseFloat(o.borderTopWidth)+parseFloat(o.borderBottomWidth)+parseFloat(o.paddingTop)+parseFloat(o.paddingBottom):"padding-box"===o.boxSizing&&(S-=parseFloat(o.borderTopWidth)+parseFloat(o.borderBottomWidth)),e.style.height=S+"px"):e.style.height=parseFloat(o.height)+(f.minHeight-r.height)+"px"),e.style.backgroundPosition=M?r.width-f.backgroundSize.width-f.backgroundPosition.right+"px "+f.backgroundPosition.top+"px":"right "+f.backgroundPosition.right+"px top "+f.backgroundPosition.top+"px",e.style.display&&(e.element.style.display=l),a.mouseHoverAnchor.dirKeys.forEach((function(t){var a="padding"+t[1];e.style[a]&&(e.element.style[a]=g[a])})),["style","hoverStyle"].forEach((function(t){var a=e[t],o=n[t];I(o)&&Object.keys(o).forEach((function(e){"string"==typeof o[e]||P(o[e])?a[e]=o[e]:null==o[e]&&delete a[e]}))})),"function"==typeof n.onSwitch&&(u=n.onSwitch),n.showEffectName&&t[n.showEffectName]&&(e.showEffectName=s=n.showEffectName),d=n.animOptions,e.elmStyle=i=e.element.style,e.mouseenter=function(t){traceLog.add("<ATTACHMENTS.mouseHoverAnchor.mouseenter>"),e.hoverStyleSave=f.getStyles(i,Object.keys(e.hoverStyle)),f.setStyles(i,e.hoverStyle),e.boundTargets.forEach((function(e){Me(e.props,!0,s,d)})),u&&u(t),traceLog.add("</ATTACHMENTS.mouseHoverAnchor.mouseenter>")},e.mouseleave=function(t){traceLog.add("<ATTACHMENTS.mouseHoverAnchor.mouseleave>"),f.setStyles(i,e.hoverStyleSave),e.boundTargets.forEach((function(e){Me(e.props,!1,s,d)})),u&&u(t),traceLog.add("</ATTACHMENTS.mouseHoverAnchor.mouseleave>")},traceLog.add("</ATTACHMENTS.mouseHoverAnchor.init>"),!0},bind:function(e,t){return traceLog.add("<ATTACHMENTS.mouseHoverAnchor.bind>"),t.props.svg?a.mouseHoverAnchor.llShow(t.props,!1,e.showEffectName):fe((function(){a.mouseHoverAnchor.llShow(t.props,!1,e.showEffectName)})),e.enabled||(e.styleSave=a.mouseHoverAnchor.getStyles(e.elmStyle,Object.keys(e.style)),a.mouseHoverAnchor.setStyles(e.elmStyle,e.style),e.removeEventListener=K(e.element,e.mouseenter,e.mouseleave),e.enabled=!0),traceLog.add("</ATTACHMENTS.mouseHoverAnchor.bind>"),!0},unbind:function(e,t){traceLog.add("<ATTACHMENTS.mouseHoverAnchor.unbind>"),e.enabled&&e.boundTargets.length<=1&&(e.removeEventListener(),a.mouseHoverAnchor.setStyles(e.elmStyle,e.styleSave),e.enabled=!1),a.mouseHoverAnchor.llShow(t.props,!0,e.showEffectName),traceLog.add("</ATTACHMENTS.mouseHoverAnchor.unbind>")},removeOption:function(e,t){a.pointAnchor.removeOption(e,t)},remove:function(e){traceLog.add("<ATTACHMENTS.mouseHoverAnchor.remove>"),e.boundTargets.length&&(traceLog.add("error-not-unbound"),console.error("LeaderLineAttachment was not unbound by remove"),e.boundTargets.forEach((function(t){a.mouseHoverAnchor.unbind(e,t)}))),traceLog.add("</ATTACHMENTS.mouseHoverAnchor.remove>")},getBBoxNest:function(e,t){return J(e.element,t.baseWindow)},llShow:function(e,a,n){t[n||e.curStats.show_effect].stop(e,!0,a),e.aplStats.show_on=a},getStyles:function(e,t){return t.reduce((function(t,a){return t[a]=e[a],t}),{})},setStyles:function(e,t){Object.keys(t).forEach((function(a){e[a]=t[a]}))}},captionLabel:{type:"label",argOptions:[{optionName:"text",type:"string"}],stats:{color:{},x:{},y:{}},textStyleProps:["fontFamily","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","kerning","letterSpacing","wordSpacing","textDecoration"],init:function(e,t){return traceLog.add("<ATTACHMENTS.captionLabel.init>"),"string"==typeof t.text&&(e.text=t.text.trim()),e.text?("string"==typeof t.color&&(e.color=t.color.trim()),e.outlineColor="string"==typeof t.outlineColor?t.outlineColor.trim():"#fff",Array.isArray(t.offset)&&P(t.offset[0])&&P(t.offset[1])&&(e.offset={x:t.offset[0],y:t.offset[1]}),P(t.lineOffset)&&(e.lineOffset=t.lineOffset),a.captionLabel.textStyleProps.forEach((function(a){null!=t[a]&&(e[a]=t[a])})),e.updateColor=function(t){traceLog.add("<ATTACHMENTS.captionLabel.updateColor>"),a.captionLabel.updateColor(e,t),traceLog.add("</ATTACHMENTS.captionLabel.updateColor>")},e.updateSocketXY=function(t){traceLog.add("<ATTACHMENTS.captionLabel.updateSocketXY>");var a,n,o,i,r=e.curStats,l=e.aplStats,s=t.curStats,d=s.position_socketXYSE[e.socketIndex];if(null==d.x)return traceLog.add("not-ready"),void traceLog.add("</ATTACHMENTS.captionLabel.updateSocketXY>");e.offset?(r.x=d.x+e.offset.x,r.y=d.y+e.offset.y):(a=e.height/2,n=Math.max(s.attach_plugSideLenSE[e.socketIndex]||0,s.line_strokeWidth/2),o=s.position_socketXYSE[e.socketIndex?0:1],4===d.socketId||2===d.socketId?(r.x=4===d.socketId?d.x-a-e.width:d.x+a,r.y=o.y<d.y?d.y+n+a:d.y-n-a-e.height):(r.x=o.x<d.x?d.x+n+a:d.x-n-a-e.width,r.y=1===d.socketId?d.y-a-e.height:d.y+a)),ke(e,l,"x",i=r.x,null,"x%_")&&(e.elmPosition.x.baseVal.getItem(0).value=i),ke(e,l,"y",i=r.y,null,"y%_")&&(e.elmPosition.y.baseVal.getItem(0).value=i+e.height),traceLog.add("</ATTACHMENTS.captionLabel.updateSocketXY>")},e.updatePath=function(t){traceLog.add("<ATTACHMENTS.captionLabel.updatePath>");var n,o,i=e.curStats,r=e.aplStats,l=t.pathList.animVal||t.pathList.baseVal;if(!l)return traceLog.add("not-ready"),void traceLog.add("</ATTACHMENTS.captionLabel.updatePath>");n=a.captionLabel.getMidPoint(l,e.lineOffset),i.x=n.x-e.width/2,i.y=n.y-e.height/2,ke(e,r,"x",o=i.x)&&(e.elmPosition.x.baseVal.getItem(0).value=o),ke(e,r,"y",o=i.y)&&(e.elmPosition.y.baseVal.getItem(0).value=o+e.height),traceLog.add("</ATTACHMENTS.captionLabel.updatePath>")},e.updateShow=function(t){traceLog.add("<ATTACHMENTS.captionLabel.updateShow>"),a.captionLabel.updateShow(e,t),traceLog.add("</ATTACHMENTS.captionLabel.updateShow>")},M&&(e.adjustEdge=function(t,n){traceLog.add("<ATTACHMENTS.captionLabel.adjustEdge>");var o=e.curStats;null!=o.x&&a.captionLabel.adjustEdge(n,{x:o.x,y:o.y,width:e.width,height:e.height},e.strokeWidth/2),traceLog.add("</ATTACHMENTS.captionLabel.adjustEdge>")}),traceLog.add("</ATTACHMENTS.captionLabel.init>"),!0):(traceLog.add("</ATTACHMENTS.captionLabel.init>"),!1)},updateColor:function(e,t){var a,n=e.curStats,o=e.aplStats,i=t.curStats;n.color=a=e.color||i.line_color,ke(e,o,"color",a)&&(e.styleFill.fill=a)},updateShow:function(e,t){var a=!0===t.isShown;a!==e.isShown&&(traceLog.add("on="+a),e.styleShow.visibility=a?"":"hidden",e.isShown=a)},adjustEdge:function(e,t,a){var n={x1:t.x-a,y1:t.y-a,x2:t.x+t.width+a,y2:t.y+t.height+a};n.x1<e.x1&&(e.x1=n.x1),n.y1<e.y1&&(e.y1=n.y1),n.x2>e.x2&&(e.x2=n.x2),n.y2>e.y2&&(e.y2=n.y2)},newText:function(e,t,a,n,o){var i,r,l,d,u,p;return(i=t.createElementNS(v,"text")).textContent=e,[i.x,i.y].forEach((function(e){var t=a.createSVGLength();t.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),e.baseVal.initialize(t)})),"boolean"!=typeof s&&(s="paintOrder"in i.style),o&&!s?(l=t.createElementNS(v,"defs"),i.id=n,l.appendChild(i),(u=(r=t.createElementNS(v,"g")).appendChild(t.createElementNS(v,"use"))).href.baseVal="#"+n,(d=r.appendChild(t.createElementNS(v,"use"))).href.baseVal="#"+n,(p=u.style).strokeLinejoin="round",{elmPosition:i,styleText:i.style,styleFill:d.style,styleStroke:p,styleShow:r.style,elmsAppend:[l,r]}):(p=i.style,o&&(p.strokeLinejoin="round",p.paintOrder="stroke"),{elmPosition:i,styleText:p,styleFill:p,styleStroke:o?p:null,styleShow:p,elmsAppend:[i]})},getMidPoint:function(e,t){var a,n,o,i=ue(e),r=i.segsLen,l=i.lenAll,s=-1;if((a=l/2+(t||0))<=0)return 2===(n=e[0]).length?te(n[0],n[1],0):oe(n[0],n[1],n[2],n[3],0);if(a>=l)return 2===(n=e[e.length-1]).length?te(n[0],n[1],1):oe(n[0],n[1],n[2],n[3],1);for(o=[];a>r[++s];)o.push(e[s]),a-=r[s];return 2===(n=e[s]).length?te(n[0],n[1],a/r[s]):oe(n[0],n[1],n[2],n[3],re(n[0],n[1],n[2],n[3],a))},initSvg:function(e,t){traceLog.add("<ATTACHMENTS.captionLabel.initSvg>");var n,o,i=a.captionLabel.newText(e.text,t.baseWindow.document,t.svg,h+"-captionLabel-"+e._id,e.outlineColor);["elmPosition","styleFill","styleShow","elmsAppend"].forEach((function(t){e[t]=i[t]})),e.isShown=!1,e.styleShow.visibility="hidden",a.captionLabel.textStyleProps.forEach((function(t){null!=e[t]&&(i.styleText[t]=e[t])})),i.elmsAppend.forEach((function(e){t.svg.appendChild(e)})),n=i.elmPosition.getBBox(),e.width=n.width,e.height=n.height,e.outlineColor&&(o=(o=n.height/9)>10?10:o<2?2:o,i.styleStroke.strokeWidth=o+"px",i.styleStroke.stroke=e.outlineColor),e.strokeWidth=o||0,we(e.aplStats,a.captionLabel.stats),e.updateColor(t),e.refSocketXY?e.updateSocketXY(t):e.updatePath(t),M&&Oe(t,{}),e.updateShow(t),traceLog.add("</ATTACHMENTS.captionLabel.initSvg>")},bind:function(e,t){traceLog.add("<ATTACHMENTS.captionLabel.bind>"),traceLog.add("optionName=%s",t.optionName);var n=t.props;return e.color||he(n,"cur_line_color",e.updateColor),(e.refSocketXY="startLabel"===t.optionName||"endLabel"===t.optionName)?(e.socketIndex="startLabel"===t.optionName?0:1,he(n,"apl_position",e.updateSocketXY),e.offset||(he(n,"cur_attach_plugSideLenSE",e.updateSocketXY),he(n,"cur_line_strokeWidth",e.updateSocketXY))):he(n,"apl_path",e.updatePath),he(n,"svgShow",e.updateShow),M&&he(n,"new_edge4viewBox",e.adjustEdge),a.captionLabel.initSvg(e,n),traceLog.add("</ATTACHMENTS.captionLabel.bind>"),!0},unbind:function(e,t){traceLog.add("<ATTACHMENTS.captionLabel.unbind>");var n=t.props;e.elmsAppend&&(e.elmsAppend.forEach((function(e){n.svg.removeChild(e)})),e.elmPosition=e.styleFill=e.styleShow=e.elmsAppend=null),we(e.curStats,a.captionLabel.stats),we(e.aplStats,a.captionLabel.stats),e.color||Se(n,"cur_line_color",e.updateColor),e.refSocketXY?(Se(n,"apl_position",e.updateSocketXY),e.offset||(Se(n,"cur_attach_plugSideLenSE",e.updateSocketXY),Se(n,"cur_line_strokeWidth",e.updateSocketXY))):Se(n,"apl_path",e.updatePath),Se(n,"svgShow",e.updateShow),M&&(Se(n,"new_edge4viewBox",e.adjustEdge),Oe(n,{})),traceLog.add("</ATTACHMENTS.captionLabel.unbind>")},removeOption:function(e,t){traceLog.add("<ATTACHMENTS.captionLabel.removeOption>"),traceLog.add("optionName=%s",t.optionName);var a=t.props,n={};n[t.optionName]="",Ie(a,n),traceLog.add("</ATTACHMENTS.captionLabel.removeOption>")},remove:function(e){traceLog.add("<ATTACHMENTS.captionLabel.remove>"),e.boundTargets.length&&(traceLog.add("error-not-unbound"),console.error("LeaderLineAttachment was not unbound by remove"),e.boundTargets.forEach((function(t){a.captionLabel.unbind(e,t)}))),traceLog.add("</ATTACHMENTS.captionLabel.remove>")}},pathLabel:{type:"label",argOptions:[{optionName:"text",type:"string"}],stats:{color:{},startOffset:{},pathData:{}},init:function(e,t){return traceLog.add("<ATTACHMENTS.pathLabel.init>"),"string"==typeof t.text&&(e.text=t.text.trim()),e.text?("string"==typeof t.color&&(e.color=t.color.trim()),e.outlineColor="string"==typeof t.outlineColor?t.outlineColor.trim():"#fff",P(t.lineOffset)&&(e.lineOffset=t.lineOffset),a.captionLabel.textStyleProps.forEach((function(a){null!=t[a]&&(e[a]=t[a])})),e.updateColor=function(t){traceLog.add("<ATTACHMENTS.pathLabel.updateColor>"),a.captionLabel.updateColor(e,t),traceLog.add("</ATTACHMENTS.pathLabel.updateColor>")},e.updatePath=function(t){traceLog.add("<ATTACHMENTS.pathLabel.updatePath>");var n,o=e.curStats,i=e.aplStats,r=t.curStats,l=t.pathList.animVal||t.pathList.baseVal;if(!l)return traceLog.add("not-ready"),void traceLog.add("</ATTACHMENTS.pathLabel.updatePath>");o.pathData=n=a.pathLabel.getOffsetPathData(l,r.line_strokeWidth/2+e.strokeWidth/2+e.height/4,1.25*e.height),ce(n,i.pathData)&&(traceLog.add("pathData"),e.elmPath.setPathData(n),i.pathData=n,e.bBox=e.elmPosition.getBBox(),e.updateStartOffset(t)),traceLog.add("</ATTACHMENTS.pathLabel.updatePath>")},e.updateStartOffset=function(t){traceLog.add("<ATTACHMENTS.pathLabel.updateStartOffset>");var a,n,o,i=e.curStats,r=e.aplStats,l=t.curStats;return i.pathData?2!==e.semIndex||e.lineOffset?(a=pe(i.pathData),o=0===e.semIndex?0:1===e.semIndex?a:a/2,2!==e.semIndex&&(n=Math.max(l.attach_plugBackLenSE[e.semIndex]||0,l.line_strokeWidth/2)+e.strokeWidth/2+e.height/4,o=(o+=0===e.semIndex?n:-n)<0?0:o>a?a:o),e.lineOffset&&(o=(o+=e.lineOffset)<0?0:o>a?a:o),i.startOffset=o,ke(e,r,"startOffset",o,null,"startOffset%_")&&(e.elmOffset.startOffset.baseVal.value=o),void traceLog.add("</ATTACHMENTS.pathLabel.updateStartOffset>")):(traceLog.add("static"),void traceLog.add("</ATTACHMENTS.pathLabel.updateStartOffset>")):(traceLog.add("not-ready"),void traceLog.add("</ATTACHMENTS.pathLabel.updateStartOffset>"))},e.updateShow=function(t){traceLog.add("<ATTACHMENTS.pathLabel.updateShow>"),a.captionLabel.updateShow(e,t),traceLog.add("</ATTACHMENTS.pathLabel.updateShow>")},M&&(e.adjustEdge=function(t,n){traceLog.add("<ATTACHMENTS.pathLabel.adjustEdge>"),e.bBox&&a.captionLabel.adjustEdge(n,e.bBox,e.strokeWidth/2),traceLog.add("</ATTACHMENTS.pathLabel.adjustEdge>")}),traceLog.add("</ATTACHMENTS.pathLabel.init>"),!0):(traceLog.add("</ATTACHMENTS.pathLabel.init>"),!1)},getOffsetPathData:function(e,t,a){var n,o,i=[];function r(e,t){return Math.abs(e.x-t.x)<3&&Math.abs(e.y-t.y)<3}return e.forEach((function(e){var a,o,l,s,d,u,p;2===e.length?(a=le(e[0],e[1],t),n?(l=n.points,(s=Math.atan2(l[1].y-l[0].y,l[0].x-l[1].x)-Math.atan2(e[0].y-e[1].y,e[1].x-e[0].x))>=0&&s<=Math.PI?o={type:"line",points:a,inside:!0}:(u=ne(l[0],l[1],t),d=ne(a[1],a[0],t),(p=ae(l[0],u,d,a[1]))?(l[1]=p,o={type:"line",points:[p,a[1]]}):(l[1]=r(d,u)?d:u,o={type:"line",points:[d,a[1]]}),n.len=ee(l[0],l[1]))):o={type:"line",points:a},o.len=ee(o.points[0],o.points[1]),i.push(n=o)):(i.push({type:"cubic",points:se(e[0],e[1],e[2],e[3],t,16)}),n=null)})),n=null,i.forEach((function(e){var o;"line"===e.type?(e.inside&&(n.len>t?((o=n.points)[1]=ne(o[0],o[1],-t),n.len=ee(o[0],o[1])):(n.points=null,n.len=0),e.len>t+a?((o=e.points)[0]=ne(o[1],o[0],-(t+a)),e.len=ee(o[0],o[1])):(e.points=null,e.len=0)),n=e):n=null})),i.reduce((function(e,t){var a=t.points;return a&&(o&&r(a[0],o)||e.push({type:"M",values:[a[0].x,a[0].y]}),"line"===t.type?e.push({type:"L",values:[a[1].x,a[1].y]}):(a.shift(),a.forEach((function(t){e.push({type:"L",values:[t.x,t.y]})}))),o=a[a.length-1]),e}),[])},newText:function(e,t,a,n){var o,i,r,l,d,u,p,c,h,S;return(l=(r=t.createElementNS(v,"defs")).appendChild(t.createElementNS(v,"path"))).id=o=a+"-path",(u=(d=t.createElementNS(v,"text")).appendChild(t.createElementNS(v,"textPath"))).href.baseVal="#"+o,u.startOffset.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PX,0),u.textContent=e,"boolean"!=typeof s&&(s="paintOrder"in d.style),n&&!s?(d.id=i=a+"-text",r.appendChild(d),(h=(p=t.createElementNS(v,"g")).appendChild(t.createElementNS(v,"use"))).href.baseVal="#"+i,(c=p.appendChild(t.createElementNS(v,"use"))).href.baseVal="#"+i,(S=h.style).strokeLinejoin="round",{elmPosition:d,elmPath:l,elmOffset:u,styleText:d.style,styleFill:c.style,styleStroke:S,styleShow:p.style,elmsAppend:[r,p]}):(S=d.style,n&&(S.strokeLinejoin="round",S.paintOrder="stroke"),{elmPosition:d,elmPath:l,elmOffset:u,styleText:S,styleFill:S,styleStroke:n?S:null,styleShow:S,elmsAppend:[r,d]})},initSvg:function(e,t){traceLog.add("<ATTACHMENTS.pathLabel.initSvg>");var n,o,i,r=a.pathLabel.newText(e.text,t.baseWindow.document,h+"-pathLabel-"+e._id,e.outlineColor);["elmPosition","elmPath","elmOffset","styleFill","styleShow","elmsAppend"].forEach((function(t){e[t]=r[t]})),e.isShown=!1,e.styleShow.visibility="hidden",a.captionLabel.textStyleProps.forEach((function(t){null!=e[t]&&(r.styleText[t]=e[t])})),r.elmsAppend.forEach((function(e){t.svg.appendChild(e)})),r.elmPath.setPathData([{type:"M",values:[0,100]},{type:"h",values:[100]}]),A&&(i=r.elmOffset.href.baseVal,r.elmOffset.href.baseVal=""),n=r.elmPosition.getBBox(),A&&(r.elmOffset.href.baseVal=i),r.styleText.textAnchor=["start","end","middle"][e.semIndex],2!==e.semIndex||e.lineOffset||r.elmOffset.startOffset.baseVal.newValueSpecifiedUnits(SVGLength.SVG_LENGTHTYPE_PERCENTAGE,50),e.height=n.height,e.outlineColor&&(o=(o=n.height/9)>10?10:o<2?2:o,r.styleStroke.strokeWidth=o+"px",r.styleStroke.stroke=e.outlineColor),e.strokeWidth=o||0,we(e.aplStats,a.pathLabel.stats),e.updateColor(t),e.updatePath(t),e.updateStartOffset(t),M&&Oe(t,{}),e.updateShow(t),traceLog.add("</ATTACHMENTS.pathLabel.initSvg>")},bind:function(e,t){traceLog.add("<ATTACHMENTS.pathLabel.bind>"),traceLog.add("optionName=%s",t.optionName);var n=t.props;return e.color||he(n,"cur_line_color",e.updateColor),he(n,"cur_line_strokeWidth",e.updatePath),he(n,"apl_path",e.updatePath),e.semIndex="startLabel"===t.optionName?0:"endLabel"===t.optionName?1:2,(2!==e.semIndex||e.lineOffset)&&he(n,"cur_attach_plugBackLenSE",e.updateStartOffset),he(n,"svgShow",e.updateShow),M&&he(n,"new_edge4viewBox",e.adjustEdge),a.pathLabel.initSvg(e,n),traceLog.add("</ATTACHMENTS.pathLabel.bind>"),!0},unbind:function(e,t){traceLog.add("<ATTACHMENTS.pathLabel.unbind>");var n=t.props;e.elmsAppend&&(e.elmsAppend.forEach((function(e){n.svg.removeChild(e)})),e.elmPosition=e.elmPath=e.elmOffset=e.styleFill=e.styleShow=e.elmsAppend=null),we(e.curStats,a.pathLabel.stats),we(e.aplStats,a.pathLabel.stats),e.color||Se(n,"cur_line_color",e.updateColor),Se(n,"cur_line_strokeWidth",e.updatePath),Se(n,"apl_path",e.updatePath),(2!==e.semIndex||e.lineOffset)&&Se(n,"cur_attach_plugBackLenSE",e.updateStartOffset),Se(n,"svgShow",e.updateShow),M&&(Se(n,"new_edge4viewBox",e.adjustEdge),Oe(n,{})),traceLog.add("</ATTACHMENTS.pathLabel.unbind>")},removeOption:function(e,t){traceLog.add("<ATTACHMENTS.pathLabel.removeOption>"),traceLog.add("optionName=%s",t.optionName);var a=t.props,n={};n[t.optionName]="",Ie(a,n),traceLog.add("</ATTACHMENTS.pathLabel.removeOption>")},remove:function(e){traceLog.add("<ATTACHMENTS.pathLabel.remove>"),e.boundTargets.length&&(traceLog.add("error-not-unbound"),console.error("LeaderLineAttachment was not unbound by remove"),e.boundTargets.forEach((function(t){a.pathLabel.unbind(e,t)}))),traceLog.add("</ATTACHMENTS.pathLabel.remove>")}}},window.ATTACHMENTS=a,Object.keys(a).forEach((function(e){Pe[e]=function(){return new n(a[e],Array.prototype.slice.call(arguments))}})),Pe.positionByWindowResize=!0,window.addEventListener("resize",H.add((function(){traceLog.add("<positionByWindowResize>"),Pe.positionByWindowResize&&Object.keys(D).forEach((function(e){traceLog.add("id=%s",e),Oe(D[e],{position:!0})})),traceLog.add("</positionByWindowResize>")})),!1),Pe}();